

=== More complex channel extraction

For higher-resolution DEMs a number of different methods have been developed to extract channel networks more accurately.  This section details how to extract channels using methods relying on geometric signatures of channel incision, primarily how it affects planform curvature. Although many methods have been developed that use a variety of planform curvature to detect channel heads from high resolution topogrpahy (e.g., https://sites.google.com/site/geonethome/home[GeoNet], which was developed by Paola Passalacqua and colleagues) , we will use the three methods available in `lsdtt-channel-extraction`


[cols="1,1,8", options="header"]
.High resolution channel extraction methods includes in `lsdtt-channel-extraction`
|===
|Name
|paramter file keyword
|Notes


|Pelletier
|`print_pelletier_channels`
|A method developed by Pelletier (2013) and implemented in **LSDTopoTools** that uses spectral filtering and tangential curvature.

|Wiener
|`print_wiener_channels`
|A method that combines some elements of the Pelletier method and some of the GeoNet method that is available within **LSDTopoTools**. It was described by https://www.earth-surf-dynam.net/4/627/2016/[Grieve et al., ESURF, 2016]. In that study it was found to be the least sensitive to grid resolution. We call this the https://en.wikipedia.org/wiki/Wiener_filter[Wiener method] since it is based on a Wiener spectral filter (the Pelletier method also uses this filter).

|Driech
|`print_dreich_channels`
|The http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract[Dreich method] 
that aims to find channel heads by looking at the break in the properties of topographic profiles 
that occur when fluvial incision gives way to hillslope sediment transport processes. It is different from the geometric methods described above in that it looks for a theoretical signal of fluvial incision rather than the planform curvature of the landscape.  


|===


The method you use should be chosen based on the particular aims of your study: if you only want a single channel network we suggest the Wiener method (see https://www.earth-surf-dynam.net/4/627/2016/[Grieve et al., ESURF, 2016] and http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract[Clubb et al., WRR, 2014]), but because the http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract[Dreich method] takes a totally different aproach to identifying channels it can be useful to compare the networks generated by these two methods to get an estimate of the uncertainty in the network extent. 


==== Switching on the high resolution extraction methods

. We are staying at Indian Creek. However, this time you will run the second parameter file:
+
[source,console]
----
# lsdtt-channel-extraction IndianCreek_example02.param
----
+
WARNING: This takes a lot longer than the threshold area method! It takes around 22 minutes on my laptop.
+
. The parameter file looks like this
+
[source,paramfile]
----
# These are parameters for the file i/o
read fname: indian_creek
channel heads fname: NULL

# Parameter for filling the DEM
min_slope_for_fill: 0.0001

# Parameters for selecting channels and basins
threshold_contributing_pixels: 1000
connected_components_threshold: 100
print_area_threshold_channels: false
print_wiener_channels: true
print_pelletier_channels: true
print_dreich_channels: true
----
+
. You will get both `sources` and `CN` files for each of these methods.
+
. The `connected_components_threshold` is the minimum number of connected pixels to create a channel. 100 is the default and for most applications you can leave this alone. 

The figures below show the extracted channel network for the Indian Creek for the three different methods.

.Map of Indian Creek with channel network extracted from Pelletier algorithm
image::images/ind_so_pel.png[Map of Indian Creek with channel network extracted from Pelletier algorithm]

.Map of Indian Creek with channel network extracted from LSDTopoTools geometric algorithm with an Optimal Wiener filter
image::images/ind_so_wiener.png[Map of Indian Creek with channel network extracted from LSDTopoTools geometric algorithm with an Optimal Wiener filter]

.Map of Indian Creek with channel network extracted from DrEICH algorithm
image::images/ind_so_dreich.png[Map of Indian Creek with channel network extracted from DrEICH algorithm]

