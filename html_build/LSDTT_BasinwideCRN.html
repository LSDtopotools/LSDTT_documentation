<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Simon M. Mudd, Marie-Alice Harel, Martin D. Hurst, Stuart W.D. Grieve, Shasta Marrero, Universities of Edinburgh and Glasgow">
<title>Basin averaged cosmogenic analysis</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Basin averaged cosmogenic analysis</h1>
<div class="details">
<span id="author" class="author">Simon M. Mudd, Marie-Alice Harel, Martin D. Hurst, Stuart W.D. Grieve, Shasta Marrero, Universities of Edinburgh and Glasgow</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quickstart">1. Quickstart</a></li>
<li><a href="#_introduction">2. Introduction</a></li>
<li><a href="#_get_the_code_and_data_basin_averaged_cosmogenic_analysis">3. Get the code and data basin-averaged cosmogenic analysis</a>
<ul class="sectlevel2">
<li><a href="#_get_the_source_code_for_basin_averaged_cosmogenics">3.1. Get the source code for basin-averaged cosmogenics</a>
<ul class="sectlevel3">
<li><a href="#_clone_the_code_from_git">3.1.1. Clone the code from Git</a></li>
<li><a href="#_compile_the_code">3.1.2. Compile the code</a></li>
</ul>
</li>
<li><a href="#_getting_example_data_the_san_bernardino_mountains">3.2. Getting example data: The San Bernardino Mountains</a></li>
<li><a href="#_setting_up_your_data_directories_and_parameter_files">3.3. Setting up your data directories and parameter files</a>
<ul class="sectlevel3">
<li><a href="#_the_parameter_file">3.3.1. The parameter file</a></li>
<li><a href="#_the_cosmogenic_data_file">3.3.2. The cosmogenic data file</a></li>
<li><a href="#_the_raster_names_file">3.3.3. The raster names file</a></li>
</ul>
</li>
<li><a href="#_modifying_your_crnrasters_file_the_python_way">3.4. Modifying your CRNRasters file the python way</a></li>
</ul>
</li>
<li><a href="#_calculating_topographic_shielding">4. Calculating Topographic Shielding</a>
<ul class="sectlevel2">
<li><a href="#_steps_for_preparing_the_rasters_for_shielding_calculations">4.1. Steps for preparing the rasters for shielding calculations</a>
<ul class="sectlevel3">
<li><a href="#_creation_of_subfolders_for_your_topographic_datasets">4.1.1. Creation of subfolders for your topographic datasets</a></li>
<li><a href="#_spawning_the_basins">4.1.2. Spawning the basins</a></li>
</ul>
</li>
<li><a href="#_the_shielding_computation">4.2. The shielding computation</a></li>
<li><a href="#_embarrassingly_parallel_shielding">4.3. Embarrassingly parallel shielding</a></li>
<li><a href="#_once_you_have_finished_with_spawning_and_topographic_shielding_calculations">4.4. Once you have finished with spawning and topographic shielding calculations</a></li>
<li><a href="#_stand_alone_topographic_shielding_calculations">4.5. Stand alone topographic shielding calculations</a></li>
</ul>
</li>
<li><a href="#_snow_shielding_calculations">5. Snow shielding calculations</a>
<ul class="sectlevel2">
<li><a href="#_using_previously_reported_snow_shielding">5.1. Using previously reported snow shielding</a>
<ul class="sectlevel3">
<li><a href="#_steps_to_use_reported_snow_shielding">5.1.1. Steps to use reported snow shielding</a></li>
</ul>
</li>
<li><a href="#_assign_a_single_effective_average_depth">5.2. Assign a single effective average depth</a></li>
<li><a href="#_pass_a_raster_of_effective_average_depth_of_snow_over_a_catchment">5.3. Pass a raster of effective average depth of snow over a catchment</a></li>
<li><a href="#_compute_snow_shielding_from_snow_water_equivalent_data">5.4. Compute snow shielding from snow water equivalent data</a></li>
</ul>
</li>
<li><a href="#_calculating_denudation_rates">6. Calculating denudation rates</a>
<ul class="sectlevel2">
<li><a href="#_compiling_the_code">6.1. Compiling the code</a></li>
<li><a href="#_running_the_basin_averaged_denudation_rate_calculator">6.2. Running the basin averaged denudation rate calculator</a></li>
<li><a href="#_the_output_files">6.3. The output files</a>
<ul class="sectlevel3">
<li><a href="#_reducing_the_output_data">6.3.1. Reducing the output data</a></li>
</ul>
</li>
<li><a href="#_nested_basins">6.4. Nested basins</a>
<ul class="sectlevel3">
<li><a href="#_how_do_i_make_an_erknown_raster">6.4.1. How do I make an _ERKnown raster?</a></li>
</ul>
</li>
<li><a href="#_soil_or_point_data">6.5. Soil or point data</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/LSD-logo.png" alt="LSD logo" width="200">
</div>
</div>
<div class="paragraph">
<p><a href="index.html">Return to main <strong>LSDTopoTools</strong> landing page</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quickstart">1. Quickstart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have developed a toolkit to automate calculation of basin (or catchement) averaged denudation rates estimated from the concentration of in situ cosmogenic nuclides in stream sediment. This toolkit is called the <a href="http://www.earth-surf-dynam.net/4/655/2016/">CAIRN method</a>.
Currently <sup>10</sup>Be and <sup>26</sup>Al are supported.</p>
</div>
<div class="paragraph">
<p>If you use this to calculate denudation rates that are later published, please cite this paper:</p>
</div>
<div class="paragraph">
<p>Mudd, S. M., Harel, M.-A., Hurst, M. D., Grieve, S. W. D., and Marrero, S. M.: The CAIRN method: automated, reproducible calculation of catchment-averaged denudation rates from cosmogenic nuclide concentrations, <em>Earth Surf. Dynam.</em>, 4, 655-674, doi:10.5194/esurf-4-655-2016, 2016.</p>
</div>
<div class="paragraph">
<p>The toolkit requires:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data on cosmogenic samples.</p>
</li>
<li>
<p>A file containing filenames of the topographic data, and optional filenames for shielding rasters.</p>
</li>
<li>
<p>A parameter file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The toolkit then produces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A csv file that contains results of the analysis.</p>
</li>
<li>
<p>A text file that can be copied into the <a href="http://hess.ess.washington.edu/math/al_be_v22/al_be_erosion_multiple_v22.php&gt;">CRONUS online calculator</a> for data comparison.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Quick guide if you already know what you are doing</div>
<div class="paragraph">
<p>If you already know what you are doing, here is a quick guide to walk you through the process.
If one of these steps doesn&#8217;t make sense see the full documentation.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You will want a directory for both the source code and the data. Make these directories. Our <a href="https://github.com/LSDtopotools/LSDTT_vagrantfiles">Vagrantfiles</a> automate this process meaning if they use them all the work setting up the system is done for you.</p>
</li>
<li>
<p>Get the latest version of the source code from <a href="https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide" class="bare">https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide</a>
If you don&#8217;t have it (i.e., if you haven&#8217;t used our vagrantfiles), use</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>or if you have it use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git pull -u origin master</code></pre>
</div>
</div>
<div class="paragraph">
<p>in your source code directory. In our vagrant machine, the source code is located in the directory <code>/LSDTopoTools/Git_projects/LSDTopoTools_CRNBasinwide</code>. You can also update the source code by using the <code>vagrant provision</code> command after you run <code>vagrant up</code>.</p>
</div>
</li>
<li>
<p>If you have just downloaded the source code, or if it has updates, you need to compile the code.
Go into the directory <strong>driver_functions_CRNBasinwide</strong>. If you use our vagrantfiles you can jump straight to the correct driectory using the the command <code>cd /LSDTopoTools/Git_projects/LSDTopoTools_CRNBasinwide/driver_functions_CRNBasinwide</code>  and use <code>make</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Spawn_DEMS_for_CRN.make
$ make -f Shielding_for_CRN.make
$ make -f Basinwide_CRN.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>After each call to <code>make</code> there will be a bunch of warnings that you can ignore.</p>
</div>
</li>
<li>
<p>In your data folder you will need a <code><strong>_CRNRasters.csv</code> file, a <code>*_CRNData.csv</code> file,
and a <code></strong>.CRNParams</code> file. If you don&#8217;t know what these are read the relevent parts of the full documentation</p>
</li>
<li>
<p>In your data folder you will also need some python scripts, which you can download individually:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/JoinSnowShielding.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/LSDOSystemTools.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/EliminateUnderscoreFromCRNDataSampleNames.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/PrepareDirectoriesForBasinSpawn.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/PrepareCRNRastersFileFromDirectory.py</code></pre>
</div>
</div>
</li>
<li>
<p>If you have some rasters (elevation, shielding, etc.) and you don&#8217;t have a <code>_CRNRasters.csv</code> file, update the path name in <code>PrepareCRNRastersFileFromDirectory.py</code> and run that script.</p>
</li>
<li>
<p>In your data folder, run <code>PrepareDirectoriesForBasinSpawn.py</code>.
You will need to update the path and the prefix at the bottom of this file.</p>
</li>
<li>
<p>In addition, sample names with the underscore character (_) are not allowed. The script
<code>EliminateUnderscoreFromCRNDataSampleNames.py</code> will replace all _ characters with <code>-</code> characters.
You need to open this file and change the target directory before running. It will modify all <code>*_CRNData.csv</code> files it finds in that directory.</p>
</li>
<li>
<p>Next up, spawn the basins. Go into the source code directory and run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Spawn_DEMs_for_CRN.exe PATHNAME DATAPREFIX</code></pre>
</div>
</div>
</li>
<li>
<p>Now, you are ready to calculate topographic shielding. You should run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Shielding_for_CRN.exe PATHNAME DATAPREFIX</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you ran the spawning the data prefix will now have a <code>*_spawned</code> in it.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is the most computationally expensive component of the process. It could take a while. In the full documentation there is some instructions as to how to do this computation using an embarrassingly parallel approach.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>If you decide to use previously reported snow shielding values, run the <code>JoinSnowShielding.py</code> function.
This will result in data files with the text <code>*_SS</code> in it.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This takes you through the process of calculating erosion rates from <sup>10</sup>Be or <sup>26</sup>Al</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_the_code_and_data_basin_averaged_cosmogenic_analysis">3. Get the code and data basin-averaged cosmogenic analysis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section goes walks you through getting the code and example data,
and also describes the different files you will need for the analysis.</p>
</div>
<div class="sect2">
<h3 id="_get_the_source_code_for_basin_averaged_cosmogenics">3.1. Get the source code for basin-averaged cosmogenics</h3>
<div class="paragraph">
<p>First navigate to the folder where you will keep your repositories.
In this example, that folder is called <code>/home/LSDTT_repositories</code>.
In a terminal window, go there with the <code>cd</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd /home/LSDTT_repositories/</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>pwd</code> command to make sure you are in the correct directory.
If you don&#8217;t have the directory, use <code>mkdir</code> to make it.</p>
</div>
<div class="sect3">
<h4 id="_clone_the_code_from_git">3.1.1. Clone the code from Git</h4>
<div class="paragraph">
<p>Now, clone the repository from <a href="https://github.com">GitHub</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/LSDTT_repositories/
$ git clone https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide.git</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_alternatively_get_the_zipped_code">Alternatively, get the zipped code</h5>
<div class="paragraph">
<p>If you don&#8217;t want to use <em>git</em>, you can download a zipped version of the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/LSDTT_repositories/
$ wget https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide/archive/master.zip
$ gunzip master.zip</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://github.com">GitHub</a> zips all repositories into a file called <code>master.zip</code>,
so if you previously downloaded a zipper repository this will overwrite it.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compile_the_code">3.1.2. Compile the code</h4>
<div class="paragraph">
<p>Okay, now you should have the code. You will still be sitting in the directory
<code>/home/LSDTT_repositories/</code>, so navigate up to the directory <code>LSDTopoTools_BasinwideCRN/driver_functions_BasinwideCRN/</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/LSDTT_repositories/
$ cd LSDTopoTools_CRNBasinwide
$ cd driver_functions_CRNBasinwide</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a number of makefiles (thse with extension <code>.make</code> in this folder).
These do a number of different things that will be explained later in this chapter.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_example_data_the_san_bernardino_mountains">3.2. Getting example data: The San Bernardino Mountains</h3>
<div class="paragraph">
<p>We have provided some example data. This is on our Github example data website.</p>
</div>
<div class="paragraph">
<p>The example data has a number of digital elevation models in various formats,
but for these examples we will be only using one dataset, from the San Bernardino Mountains in California.</p>
</div>
<div class="paragraph">
<p>You should make a folder for your data using <code>mkdir</code> somewhere sensible.
For the purposes of this tutorial I&#8217;ll put it in the following folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/ExampleDatasets/SanBernardino/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, we will only take the data we need, so use wget to download the data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/SanBern.bil
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/SanBern.hdr
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/example_parameter_files/SanBern_CRNData.csv
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/example_parameter_files/SanBern_CRNRasters.csv
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/example_parameter_files/SanBern.CRNParam</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should now have the following files in your data folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/ExampleDatasets/SanBernardino/
$ ls
SanBern.bil    SanBern_CRNData.csv     SanBern.CRNParam
SanBern.hdr    SanBern_CRNRasters.csv</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The file <code>SanBern_CRNRasters.csv</code> will need to be modified with the appropriate paths to your files! We will describe how to do that below.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_your_data_directories_and_parameter_files">3.3. Setting up your data directories and parameter files</h3>
<div class="paragraph">
<p>Before you can run the code, you need to set up some data structures.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you downloaded the example data, these files will already exist.
These instructions are for when you need to run CRN analysis on your own datasets.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You can keep your topographic data separate from your cosmogenic data, if you so desire.
You&#8217;ll need to know the directory paths to these data.</p>
</li>
<li>
<p>In a single folder (again, it can be separate from topographic data),
you must put a i) <strong>parameter file</strong>, a <strong>cosmogenic data file</strong>, and a <strong>raster filenames file</strong> .</p>
</li>
<li>
<p>These three files must have the same <strong>prefix</strong>, and each have their own extensions.</p>
<div class="ulist">
<ul>
<li>
<p>The <strong>parameter file</strong> has the extension: <code>.CRNParam</code>.</p>
</li>
<li>
<p>The <strong>cosmogenic data file</strong> has the extension <code>_CRNData.csv</code>.</p>
</li>
<li>
<p>The <strong>raster filenames file</strong> has the extension <code>_CRNRasters.csv</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For example, if the prefix of your files is <code>SanBern</code>,
then your three data files will be <code>SanBern.CRNParam</code>,
<code>SanBern_CRNData.csv</code>, and <code>SanBern_CRNRasters.csv</code>.</p>
</li>
<li>
<p>If the files do not have these naming conventions, the code <strong>WILL NOT WORK</strong>!
Make sure you have named your files properly.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_the_parameter_file">3.3.1. The parameter file</h4>
<div class="paragraph">
<p>The parameter file contains some values that are used in the calculation of both shielding and erosion rates.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This file must have the extension <code>.CRNParam</code>. The extension is <strong>case sensitive</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter file could be empty, in which case parameters will just take default values.
However, you may set various parameters. The format of the file is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">parameter_name: parameter_value</code></pre>
</div>
</div>
<div class="paragraph">
<p>So for example a parameter file might look like:</p>
</div>
<div class="listingblock">
<div class="title">An example CRNparam file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">min_slope: 0.0001
source_threshold: 12
search_radius_nodes: 1
threshold_stream_order: 1
theta_step: 30
phi_step: 30
Muon_scaling: Braucher
write_toposhield_raster: true
write_basin_index_raster: true</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
There cannot be a space between the parameter name and the ":" character,
so <code>min_slope : 0.0002</code> will fail and you will get the default value.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In fact all of the available parameters are listed above, and those listed above are default values.
The parameter names are not case sensitive. The parameter values are case sensitive.
These parameters are as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. File input and output options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 50.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">min_slope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimum slope between pixels used in the filling function (dimensionless)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source_threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pixels that must drain into a pixel to form a channel.
This parameter makes little difference, as the channel network only plays a role in
setting channel pixels to which cosmo samples will snap. This merely needs to be
set to a low enough value that ensures there are channels associated with each
cosmogenic sample.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">search_radius_nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of pixels around the location of the cosmo location to search for
a channel. The appropriate setting will depend on the difference between the
accuracy of the GPS used to collect sample locations and the resolution of the DEM.
If you are using a 30 or 90m DEM, 1 pixel should be sufficient. More should be used
for LiDAR data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">threshold_stream_order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimum stream or which the sample snapping routine considers a 'true' channel. The input is a <a href="https://en.wikipedia.org/wiki/Strahler_number">Strahler stream order</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">theta_step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Using in toposhielding calculations. This is the step of azimuth (in degrees) over which shielding and
shadowing calculations are performed. <a href="http://onlinelibrary.wiley.com/doi/10.1002/esp.1336/abstract">Codilean (2005)</a>
recommends 5, but it seems to work without big changes
differences with 15. An integer that must be divisible by 360 (although if not the code will force it to
the closest appropriate integer).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">phi_step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Using in toposhielding calculations. This is the step of inclination (in degrees) over which shielding and
shadowing calculations are performed. <a href="http://onlinelibrary.wiley.com/doi/10.1002/esp.1336/abstract">Codilean (2005)</a>
recommends 5, but it seems to work without big changes
differences with 10. An integer that must be divisible by 360 (although if not the code will force it to
the closest appropriate integer).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path_to_atmospheric_data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to the atmospheric data. <strong>DO NOT CHANGE</strong>. This is included in the repository so should work if you have cloned our git repository. Moving this data and playing with the location the atmospheric data is likeley to break the program.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Muon_scaling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Braucher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The scaling scheme for muons. Options are "Braucher", "Schaller" and "Granger". If you give
the parameter file something other than this it will default to Braucher scaling. These scalings take values
reported in <a href="http://www.ucl.ac.uk/~ucfbpve/cosmocalc/">COSMOCALC</a> as described by
<a href="http://onlinelibrary.wiley.com/doi/10.1029/2006GC001530/abstract">Vermeesch 2007</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write_toposhield_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true this writes a toposhielding raster if one does not exist.
Saves a bit of time but will take up some space on your hard disk!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write_basin_index_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each DEM this writes an LSDIndexRaster to file with the extension <code>_BASINS</code> that
has each of the basins that have been found for CRN analysis listed by basinID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write_full_scaling_rasters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This writes three rasters if true: a raster with <code>_PROD</code> that contains the Lal/Stone production scaling (not the production rate),
a raster with extension <code>_CSHIELD</code> that is the combined shielding (the product of snow, self and topographic shielding), a raster with extension <code>_CSCALE</code>, which is the pixel by pixel product of the production scaling and shielding, and a raster with extension <code>_PRES</code> which is the atmospheric pressure scaled for elevation and latitude rome the NCEP reanalysis.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_the_cosmogenic_data_file">3.3.2. The cosmogenic data file</h4>
<div class="paragraph">
<p>This file contains the actual cosmogenic data: it has the locations of samples,
their concentrations of cosmogenics (<sup>10</sup>Be and <sup>26</sup>Al) and the uncertainty of these concentrations.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The cosmogenic data file must have the extension <code>_CRNData.csv</code>.
The extension is case sensitive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is a <code>.csv</code> file: that is a comma separated value file. It is in that format to be both excel and
<a href="http://pandas.pydata.org/">pandas</a> friendly.</p>
</div>
<div class="paragraph">
<p>The first row is a header that names the columns,
after that there should be 7 columns (separated by commas) and unlimited rows. The seven columns are:</p>
</div>
<div class="paragraph">
<p>sample_name, sample_latitude, sample_longitude, nuclide, concentration, AMS_uncertainty, standardisation</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Important notes about <strong>_CRNData.csv</strong> files</div>
<div class="ulist">
<ul>
<li>
<p>The sample name <strong>should not have spaces or underscore characters</strong>. If it has an underscore, you can run our script
<code>EliminateUnderscoreFromCRNDataSampleNames.py</code>, which is located here: <a href="https://github.com/LSDtopotools/LSDAutomation" class="bare">https://github.com/LSDtopotools/LSDAutomation</a>
The script will replace underscores with <code>-</code> characters. The reason for this is that our code uses the <code>_</code> as a separator
in filenames.</p>
</li>
<li>
<p>The latitude and longitude should be in decimal degrees. Negative latitude indicates southern hemisphere.</p>
</li>
<li>
<p>Nuclide can be either <strong>"Be10"</strong> or <strong>"Al26"</strong>. Any other option will be rejected.</p>
</li>
<li>
<p>Concentration is in atoms/gram</p>
</li>
<li>
<p>AMS uncertainty is also in atoms/gram</p>
</li>
<li>
<p>Standardisation is the name of the standards used in the AMS measurements. This is not always so easy to find
in published papers!! The defaults are "07KNSTD" for <sup>10</sup>Be and "KNSTD" for <sup>26</sup>Al. These seem to be used by many
people after 2007 when <a href="http://www.ssl.berkeley.edu/cosmochem/about.html">Kuni Nishiizumi</a> made them available (or at least that is when he published the paper).
If the samples are from before 2007 and you don&#8217;t know the standard use, you should use "KNSTD" for <sup>10</sup>Be and <sup>26</sup>Al.
There are many more standards floating around, but the Nishiizumi one seem the most widely used.
The options are (take a deep breath), for <sup>10</sup>Be:</p>
<div class="listingblock">
<div class="title">Options for <sup>10</sup>Be standardisation</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">"07KNSTD", "KNSTD", "NIST_Certified", "LLNL31000", "LLNL10000", "LLNL3000", "LLNL1000"
"LLNL300", "NIST_30000", "NIST_30200", "NIST_30300", "NIST_30600", "NIST_27900"
"S555","S2007", "BEST433", "BEST433N", "S555N", "S2007N"</code></pre>
</div>
</div>
<div class="paragraph">
<p>And for <sup>26</sup>Al:</p>
</div>
<div class="listingblock">
<div class="title">Options for <sup>26</sup>Al standardisation</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">"KNSTD", "ZAL94", "SMAL11", "0", "ZAL94N", "ASTER", "Z92-0222"</code></pre>
</div>
</div>
</li>
<li>
<p>In addition, you can have an <strong>optional</strong> column for the snow shielding.
This is intended to be used for places where you are attempting to reproduce erosion rates from previously reported snow shielding values.
We describe the snow shielding options later in the documentation, but if you include this number it will be a float between 0 (for total sheilding)
and 1 (for no shielding).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>An example file would look like this (this is not real data):</p>
</div>
<div class="listingblock">
<div class="title">An example _CRNData.csv file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Sample_name,Latitude,Longitude,Nuclide,Concentration,Uncertainty,Standardisation
LC07_01,-32.986389,-71.4225,Be10,100000,2500,07KNSTD
LC07_04,-32.983528,-71.415556,Be10,150000,2300,07KNSTD
LC07_06,-32.983028,-71.415833,Al26,4000,2100,KNSTD
LC07_08,-32.941333,-71.426583,Be10,30000,1500,07KNSTD
LC07_10,-33.010139,-71.435389,Be10,140000,25000,07KNSTD
LC07_11,-31.122417,-71.576194,Be10,120502,2500,07KNSTD</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, with reported snow shielding:</p>
</div>
<div class="listingblock">
<div class="title">An example _CRNData.csv file with snow shielding</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Sample_name,Latitude,Longitude,Nuclide,Concentration,Uncertainty,Standardisation, Snow_shielding
LC07_01,-32.986389,-71.4225,Be10,100000,2500,07KNSTD,0.7
LC07_04,-32.983528,-71.415556,Be10,150000,2300,07KNSTD,0.8
LC07_06,-32.983028,-71.415833,Al26,4000,2100,KNSTD,1.0
LC07_08,-32.941333,-71.426583,Be10,30000,1500,07KNSTD,1.0
LC07_10,-33.010139,-71.435389,Be10,140000,25000,07KNSTD,1.0
LC07_11,-31.122417,-71.576194,Be10,120502,2500,07KNSTD,0.987</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you followed the instructions earlier in the section <a href="#_getting_example_data_the_san_bernardino_mountains">Getting example data: The San Bernardino Mountains</a>
then you will have a <code>CRNdata.csv</code> file called <code>Binnie_CRNData.csv</code> in your data folder.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. CRNData.csv format (the first row contains a header)</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 50.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Heading</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The sample name <strong>NO spaces or underscore characters!</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latitude in decimal degrees.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Longitude in decimal degrees.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nuclide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The nuclide. Options are <code>Al26</code> and <code>Be10</code>. Anything else will be rejected.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concentration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concentration of the nuclide in atoms g<sup>-1</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty of the concentration of the nuclide in atoms g<sup>-1</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standardization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The standardization for the AMS measurments. See table below for options.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reported snow shielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The reported snow shielding value for a basin. Should be a ratio between 0 (fully shielded) and 1 (no shielding).
<strong>This column is OPTIONAL</strong>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Nuclide standardisation options</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Nuclide</th>
<th class="tableblock halign-left valign-top">Options</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><sup>10</sup>Be</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>07KNSTD</code>, <code>KNSTD</code>, <code>NIST_Certified</code>, <code>LLNL31000</code>, <code>LLNL10000</code>, <code>LLNL3000</code>, <code>LLNL1000</code>
<code>LLNL300</code>, <code>NIST_30000</code>, <code>NIST_30200</code>, <code>NIST_30300</code>, <code>NIST_30600</code>, <code>NIST_27900</code>
<code>S555</code>,<code>S2007</code>, <code>BEST433</code>, <code>BEST433N</code>, <code>S555N</code>, <code>S2007N</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><sup>26</sup>Al</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KNSTD</code>, <code>ZAL94</code>, <code>SMAL11</code>, <code>0</code>, <code>ZAL94N</code>, <code>ASTER</code>, <code>Z92-0222</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_the_raster_names_file">3.3.3. The raster names file</h4>
<div class="paragraph">
<p>This file contains names of rasters that you want to analyze.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The raster names file must have the extension <code>_CRNRasters.csv</code>.
The extension is case sensitive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This file is a csv file that has as many rows as you have rasters that cover your CRN data.
Each row can contain between 1 and 4 columns.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first column is the <strong>FULL</strong> path name to the Elevation raster and its prefix (that is, without the <code>.bil</code>, e.g.:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">/home/smudd/basin_data/Chile/CRN_basins/Site01/Site_lat26p0_UTM19_DEM</code></pre>
</div>
</div>
</li>
<li>
<p>The next column is <strong>either</strong> a full path name to a snow shielding raster <strong>or</strong> a snow shielding effective depth.
Both the raster and the single value should have units of g/cm^2 snow depth. If there is no number here
the default is 0.</p>
</li>
<li>
<p>The next column is <strong>either</strong> a full path name to a self shielding raster <strong>or</strong> a self shielding effective depth.
Both the raster and the single value should have units of g/cm<sup>2</sup> shielding depth. If there is no number here
the default is 0.</p>
</li>
<li>
<p>The next column is the <strong>FULL</strong> path to a toposhielding raster. If this is blank the code will run topographic
shielding for you.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
topographic shielding is the most computationally demanding step in the cosmo analysis.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A typical file might will look like this:</p>
</div>
<div class="listingblock">
<div class="title">An example CRNRasters.csv file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">/home//basin_data/Site01/Site01_DEM,0,0,/home/basin_data/Site01/Site01_DEM_TopoShield
/home/basin_data/Site02/Site02_DEM,5,10
/home/basin_data/Site03/Site03_DEM,5,/home/basin_data/Site03/Site03_DEM_SelfShield
/home/basin_data/Site04/Site04_DEM,/home/basin_data/Site04/Site04_DEM_SnowShield,/home/basin_data/Site04/Site04_DEM_SelfShield
/home/basin_data/Site05/Site05_DEM
/home/basin_data/Site06/Site06_DEM,/home/basin_data/Site06/Site06_DEM_SnowShield</code></pre>
</div>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. CRNRasters.csv format (the first row contains a header)</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 37.5%;">
<col style="width: 12.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Heading</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path and prefix of elevation data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path and prefix of elevation data; does not include the extension (that is, does not include <code>.flt</code> or <code>.bil</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Snow shielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>or</strong> string <strong>or</strong> empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could be empty, or contain a float, in which case it is the effective depth of snow (g cm<sup>-2</sup>) across the entire basin <strong>or</strong>
a string with the path and file prefix of the snow depth (g cm<sup>-2</sup>) raster. If empty, snow depth is assumed to be 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Self shielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>or</strong> string <strong>or</strong> empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could be empty, or contain a float, in which case it is the effective depth of material eroded(g cm<sup>-2</sup>) across the entire basin <strong>or</strong>
a string with the path and file prefix of the eroded depth (g cm<sup>-2</sup>) raster. If empty, eroded depth is assumed to be 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Topo shielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string <strong>or</strong> empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This could be empty <strong>or</strong> could contain
a string with the path and file prefix of the topographic shielding (a ratio between 0 and 1) raster.
If empty topographic shielding is assumed to be 1 (i.e., no shielding).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_modifying_your_crnrasters_file_the_python_way">3.4. Modifying your CRNRasters file the python way</h3>
<div class="paragraph">
<p>The <code>_CRNRasters.csv</code> file contains the path names and the file prefixes of the rasters to be used in the analysis.
The paths will vary depending on your own file structures.
Updating these paths by hand can be quite tedious, so we have prepared a python script to automate this process.
You can get this script here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/LSDOSystemTools.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/PrepareCRNRastersFileFromDirectory.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>The script <code>LSDOSystemTools.py</code> contians some tools for managing paths and files, the actual work is done by the script <code>PrepareCRNRastersFileFromDirectory.py</code>.</p>
</div>
<div class="paragraph">
<p>In an editor, go into <code>PrepareCRNRastersFileFromDirectory.py</code> and navigate to the bottom of the file.
Change the <code>path</code> to point to the directory with your DEMs. The <code>prefix</code> is the prefix of your files, so in this example change <code>prefix</code> to <code>SanBern</code>.
You can then run the script with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ python PrepareCRNRastersFileFromDirectory.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script will then update the <code>_CRNRasters.csv</code> file to reflect your directory structure. The script also detects any associated shielding rasters.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calculating_topographic_shielding">4. Calculating Topographic Shielding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cosmogenic nuclides are produced at or near the Earth&#8217;s surface by cosmic rays,
and these rays can be blocked by topography (i.e., big mountains cast "shadows" for cosmic rays).</p>
</div>
<div class="paragraph">
<p>In most cases, you will not have topographic shielding rasters available, and will need to calculate these.</p>
</div>
<div class="paragraph">
<p>Shielding calculation are computationally intensive, much more so than the actual erosion rate computations.
Because of the computational expense of shielding calculations, we have prepared a series of tools for speeding this computation.</p>
</div>
<div class="paragraph">
<p>The topographic shielding routines take the rasters from the <code>_CRNRasters.csv</code> file and the <code>_CRNData.csv</code> file and computes the location of all CRN basins.
They then clips a DEM around the basins (with a pixel buffer set by the user).
These clipped basins are then used to make the shielding calculations and the erosion rate calculations.</p>
</div>
<div class="paragraph">
<p>This process of clipping out each basin spans a large number of new DEM that require a new directory structure.
A python script is provided to set up this directory structure in order to organize the new rasters.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<strong>This process uses a large amount of storage on the hard disk because a new DEM will be written for each CRN basin.</strong>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_steps_for_preparing_the_rasters_for_shielding_calculations">4.1. Steps for preparing the rasters for shielding calculations</h3>
<div class="sect3">
<h4 id="_creation_of_subfolders_for_your_topographic_datasets">4.1.1. Creation of subfolders for your topographic datasets</h4>
<div class="paragraph">
<p>The first step is to create some subfolders to store topographic data.
We do this using a python script</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, place the <code>_CRNRasters.csv</code> and <code>_CRNData.csv</code> file into the same folder,
and make sure the <code>_CRNRasters.csv</code> file points to the directories that contain the topographic data.
If you are working with the example data (see section <a href="#_getting_example_data_the_san_bernardino_mountains">Getting example data: The San Bernardino Mountains</a>),
you should navigate to the folder with the data (for this example, the folder is in <code>/home/ExampleDatasets/SanBernardino/</code>):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ pwd
/home/ExampleDatasets/SanBernardino/
$ ls
SanBern_CRNData.csv  SanBern_CRNRasters.csv  SanBern.hdr
SanBern.bil         SanBern.CRNparam</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will then need to modify <code>SanBern_CRNRasters.csv</code> to reflect your directory:</p>
</div>
<div class="listingblock">
<div class="title">Modify your <code>SanBern_CRNRasters.csv</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">/home/ExampleDatasets/SanBernardino/SanBern</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each line in this file points to a directory holding the rasters to be analyzed.</p>
</div>
<div class="paragraph">
<p>In this case we are not supplying and shielding rasters.
For more details about the format of this file see the section: <a href="#_the_raster_names_file">The raster names file</a>.</p>
</div>
</li>
<li>
<p>Second, run the python script <code>PrepareDirectoriesForBasinSpawn.py</code>.</p>
<div class="ulist">
<ul>
<li>
<p>You can clone this script from GitHub; find it here: <a href="https://github.com/LSDtopotools/LSDAutomation" class="bare">https://github.com/LSDtopotools/LSDAutomation</a>
You will also need the file <code>LSDOSystemTools.py</code> from this repository.
The <code>LSDOSystemTools.py</code> file contains some scripts for making sure directories are in the correct format,
and for changing filenames if you happen to be switching between Linux and Windows.
It is unlikely that you will need to concern yourself with its contents, as long as
it is present in the same folder as the <code>PrepareDirectoriesForBasinSpawn.py</code> file.</p>
<div class="paragraph">
<p>The scripts can be downloaded directly using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/PrepareDirectoriesForBasinSpawn.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/LSDOSystemTools.py</code></pre>
</div>
</div>
</li>
<li>
<p>You will need to scroll to the bottom of the script and change the <code>path</code>
(which is simply the directory path of the <code>_CRNRasters.csv</code> file.</p>
</li>
<li>
<p>You will need to scroll to the bottom of the script and change the <code>prefix</code>
(which is simply prefix of the <code>_CRNRasters.csv</code> file; that is the filename before <code>_CRNRasters.csv</code>
so if the filename is <code>YoYoMa_CRNRasters.csv</code> then <code>prefix</code> is <code>YoYoMa</code>. Note this is case sensitive.</p>
<div class="paragraph">
<p>In this example, scroll to the bottom of the file and change it to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">if __name__ == "__main__":
    path = "/home/ExampleDatasets/SanBernardino"
    prefix = "SanBern"
    PrepareDirectoriesForBasinSpawn(path,prefix)</code></pre>
</div>
</div>
</li>
<li>
<p>This python script does several subtle things like checking directory paths and then makes a new folder for each DEM.
The folders will contain all the CRN basins located on the source DEM.</p>
<div class="paragraph">
<p>If you are using the example data, the rather trivial result will be a directory called <code>SanBern</code>.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_spawning_the_basins">4.1.2. Spawning the basins</h4>
<div class="paragraph">
<p>Now you will run a C++ program that spawns small rasters that will be used for shielding calculations.
First you have to compile this program.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To compile, navigate to the folder <code>/home/LSDTT_repositories/LSDTopoTools_CRNBasinwide/driver_functions_CRNBasinwide/</code>.
If you put the code somewhere else, navigate to that folder.
Once you are in the folder with the driver functions, type:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Spawn_DEMs_for_CRN.make</code></pre>
</div>
</div>
</li>
<li>
<p>The program will then compile (you may get some warnings&#8212;&#8203;ignore them.)</p>
</li>
<li>
<p>In the <code>/driver_functions_CRNTools/</code> folder, you will now have a program <code>Spawn_DEMs_for_CRN.exe</code>.
You need to give this program two arguments.</p>
</li>
<li>
<p>You need to give <code>Spawn_DEMs_for_CRN.exe</code>, the path to the data files (i.e., <code>_CRNRasters.csv</code> and <code>_CRNData.csv</code>),
and the prefix, so if they are called  <code>YoMa_CRNRaster.csv</code> the prefix is <code>YoMa</code>). In this example the prefix will be <code>SanBern</code>.
Run this with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PS&gt; Spawn_DEMs_for_CRN.exe PATHNAME DATAPREFIX</code></pre>
</div>
</div>
<div class="paragraph">
<p>in windows or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Spawn_DEMs_for_CRN.exe PATHNAME DATAPREFIX</code></pre>
</div>
</div>
<div class="paragraph">
<p>in Linux.</p>
</div>
<div class="paragraph">
<p>In our example, you should run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Spawn_DEMs_for_CRN.exe /home/ExampleDatasets/SanBernardino/ SanBern</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The PATHNAME <strong>MUST</strong> have a frontslash at the end.
<code>/home/ExampleDatasets/SanBernardino/</code> will work whereas <code>/home/ExampleDatasets/SanBernardino</code> will lead to an error.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Once this program has run, you should have subfolders containing small DEMs that contain the basins to be analyzed.
There will be one for every cosmogenic sample that lies within the DEM.</p>
</li>
<li>
<p>You will also have files that contain the same <code>PATHNAME</code> and <code>PREFIX</code> but have <code>_Spawned</code> added to the prefix.
For example, if your original prefix was  <code>CRN_test</code>, the new prefix will be <code>CRN_test_Spawned</code>.</p>
</li>
<li>
<p>In the file <code>PREFIX_Spawned_CRNRasters.csv</code> you will find the paths and prefixes of all the spawned basins.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_shielding_computation">4.2. The shielding computation</h3>
<div class="paragraph">
<p>The shielding computation is the most computationally expensive step of the CRN data analysis.
Once you have spawned the basins (see above section,
<a href="#_steps_for_preparing_the_rasters_for_shielding_calculations">Steps for preparing the rasters for shielding calculations</a>), you will need to run the shielding calculations.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You will first need to compile the program that calculates shielding. This can be compiled with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Shielding_for_CRN.make</code></pre>
</div>
</div>
</li>
<li>
<p>The compiled program (<code>Shielding_for_CRN.exe</code>) takes two arguments: the <code>PATHNAME</code> and the <code>PREFIX</code>.</p>
</li>
<li>
<p>You could simply run this on a single CPU after spawning the basins;
for example if the original data had the prefix <code>CRN_test</code> before spawning, you could run the program with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Shielding_for_CRN.exe PATHNAME CRN_test_Spawned</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>PATHNAME</code> is the path to your <code>_CRNRasters.csv</code>, <code>_CRNData.csv</code>, and <code>.CRNParam</code> (<strong>these files need to be in the same path</strong>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you only wanted to do a subset of the basins, you can just delete rows from the <code>*_Spawned_CRNRasters.csv</code> file as needed.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will produce a large number of topographic shielding rasters (with <code>_SH</code> in the filename), for example:</p>
</div>
<div class="listingblock">
<div class="title">A partial list of files generated by spawning operation</div>
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">smudd@burn SanBern $ ls
SpawnedBasin_10.bil  SpawnedBasin_17.bil  SpawnedBasin_7.bil       SpawnedBasin_MHC-13.bil
SpawnedBasin_10.hdr  SpawnedBasin_17.hdr  SpawnedBasin_7.hdr       SpawnedBasin_MHC-13.hdr
SpawnedBasin_11.bil  SpawnedBasin_18.bil  SpawnedBasin_8.bil       SpawnedBasin_MHC-14.bil
SpawnedBasin_11.hdr  SpawnedBasin_18.hdr  SpawnedBasin_8.hdr       SpawnedBasin_MHC-14.hdr
SpawnedBasin_12.bil  SpawnedBasin_19.bil  SpawnedBasin_9.bil       SpawnedBasin_MHC-15.bil
SpawnedBasin_12.hdr  SpawnedBasin_19.hdr  SpawnedBasin_9.hdr       SpawnedBasin_MHC-15.hdr</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Shielding.jpg" alt="Shielding raster">
</div>
<div class="title">Figure 1. One of the shielding rasters (for sample name <code>18</code>) from the San Bernardino dataset (viewed in QGIS2.2)</div>
</div>
</div>
<div class="sect2">
<h3 id="_embarrassingly_parallel_shielding">4.3. Embarrassingly parallel shielding</h3>
<div class="paragraph">
<p>We provide a python script for running multiple basins using an <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel">embarrassingly parallel</a> approach.
It is written for our cluster:
if your cluster uses <code>qsub</code> or equivalent, you will need to write your own script.
However, this will work on systems where you can send jobs directly.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To set the system up for embarrassingly parallel runs, you need to run the python script <code>ManageShieldingComputation.py</code>,
which can be found here: <a href="https://github.com/LSDtopotools/LSDAutomation" class="bare">https://github.com/LSDtopotools/LSDAutomation</a>.
You can download it with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/ManageShieldingComputation.py</code></pre>
</div>
</div>
</li>
<li>
<p>In <code>ManageShieldingComputation.py</code>, navigate to the bottom of the script, and enter the <code>path</code>, <code>prefix</code>, and <code>NJobs</code>.
<code>NJobs</code> is the number of jobs into which you want to break up the shielding computation.</p>
</li>
<li>
<p>Once you run this computation, you will get files with the extension <code>_bkNN</code> where <code>NN</code> is a job number.</p>
</li>
<li>
<p>In addition a text file is generated, with the extension <code>_ShieldCommandPrompt.txt</code>,
and from this you can copy and paste job commands into a Linux terminal.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<strong>These commands are designed for the GeoSciences cluster at the University of Edinburgh:
if you use <code>qsub</code> you will need to write your own script</strong>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Note that the parameters for the shielding calculation are in the <code>.CRNParam</code> files. We recommend:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">theta_step:8
phi_step: 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>These are based on extensive sensitivity analyses and balance computational speed with accuracy.
Errors will be &lt;&lt; 1% even in landscapes with extremely high relief. Our forthcoming paper has details on this.</p>
</div>
</li>
<li>
<p>Again, these computations take a long time. <strong>Don&#8217;t start them a few days before your conference presentation!!</strong></p>
</li>
<li>
<p>Once the computations are finished, there will be a shielding raster for every spawned basin raster.
In addition, the <code>_CRNRasters.csv</code> file will be updated to reflect the new
shielding rasters so that the updated parameter files can be fed directly into the erosion rate calculators.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_once_you_have_finished_with_spawning_and_topographic_shielding_calculations">4.4. Once you have finished with spawning and topographic shielding calculations</h3>
<div class="paragraph">
<p>If you are not going to assimilate reported snow shielding values, you can move on to the erosion rate calculations.
If you are going to assimilate reported snow shielding values, please read the section: <a href="#_using_previously_reported_snow_shielding">Using previously reported snow shielding</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stand_alone_topographic_shielding_calculations">4.5. Stand alone topographic shielding calculations</h3>
<div class="paragraph">
<p>We also provide a stand alone program just to calculate topographic shielding. This may be useful for samples collected for
measuring exposure ages or for working in other settings such as active coastlines.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You will first need to compile the program that calculates topographic shielding. This can be compiled with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f TopoShielding.make</code></pre>
</div>
</div>
</li>
<li>
<p>The compiled program (<code>TopoShielding.out</code>) takes four arguments: the <code>PATHNAME</code>, the <code>PREFIX</code>, the <code>AZIMUTH STEP</code> and the <code>ANGLE STEP</code>.</p>
</li>
<li>
<p>You could simply run this on a single CPU;
for example if the original DEM had the prefix <code>CRN_TEST</code> before spawning, and you wanted to use an <code>AZIMUTH_STEP=5</code> and <code>ANGLE_STEP=5</code>,
you could run the program with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./TopoShielding.out PATHNAME CRN_TEST 5 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>PATHNAME</code> is the path to your <code>CRN_TEST</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DEM must be in ENVI *.bil format. See <a href="LSDTT_introduction_to_geospatial_data.html#_what_data_does_lsdtopotools_take">information about LSDTopoTools data formats</a>.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will produce a single topographic shielding raster (with <code>_TopoShield</code> in the filename).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_snow_shielding_calculations">5. Snow shielding calculations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Snow absorbs cosmic rays and so CRN concentrations in sediments can be affected
by snow that has been present in the basin during the period that eroded materials were exposed to cosmic rays.</p>
</div>
<div class="paragraph">
<p>Estimating snow shielding is notoriously difficult
(how is one to rigorously determine the thickness of snow averaged over the last few thousand years?),
and our software does not prescribe a method for calculating snow shielding.</p>
</div>
<div class="paragraph">
<p>Rather, our tools allow the user to set snow shielding in 3 ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use a previously reported basinwide average snow shielding factor</p>
</li>
<li>
<p>Assign a single effective average depth of snow over a catchment (in g cm<sup>-2</sup>).</p>
</li>
<li>
<p>Pass a raster of effective average depth of snow over a catchment (in g cm<sup>-2</sup>).</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_using_previously_reported_snow_shielding">5.1. Using previously reported snow shielding</h3>
<div class="paragraph">
<p>Some authors report a snow shielding factor in their publications.
The underlying information about snow and ice thickness used to generate the snow shielding factor is usually missing.
Because under typical circumstances the spatial distribution of snow thicknesses is not reported, we use reported snow shielding factors
to calculate an effective snow thickness across the basin.</p>
</div>
<div class="paragraph">
<p>This approach is only compatible with our spawning method (see the section on <a href="#_spawning_the_basins">Spawning the basins</a>),
because this average snow thickness will only apply to the raster containing an individual sample&#8217;s basin.</p>
</div>
<div class="paragraph">
<p>The effective snow thickness is calculated by:</p>
</div>
<div class="stemblock">
<div class="title">Converting snow shielding to an effective depth</div>
<div class="content">
\[d_{eff} = -\Gamma_0*\ln(S_s)\]
</div>
</div>
<div class="paragraph">
<p>where \(d_{eff}\) is the effective depth (g cm<sup>-2</sup>), \(\Gamma_0\) is the attenuation mass (= 160 g cm<sup>-2</sup>) for spallation (we do not consider the blocking of muons by snow), and, \(S_s\) is the reported snow shielding.</p>
</div>
<div class="paragraph">
<p>The reported snow shielding values should be inserted as the 8th column in the <code>CRNData.csv</code> file.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="title">A CRNData.csv file with shielding (Note this is not actual data! The snow shielding values are random).</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Sample_name,Latitude,Longitude,Nuclide,Concentration,Uncertainty,Standardisation,Snow_shield
20,34.3758,-117.09,Be10,215100,9400,07KNSTD,0.661531836
15,34.3967,-117.076,Be10,110600,7200,07KNSTD,0.027374149
19,34.4027,-117.063,Be10,84200,6500,07KNSTD,0.592583113
17,34.2842,-117.056,Be10,127700,5800,07KNSTD,0.158279369
14,34.394,-117.054,Be10,101100,6100,07KNSTD,0.047741051
18,34.2794,-117.044,Be10,180600,10000,07KNSTD,0.559339639
11,34.1703,-117.044,Be10,7700,1300,07KNSTD,0.210018127
16,34.2768,-117.032,Be10,97300,5500,07KNSTD,0.317260607
10,34.2121,-117.015,Be10,74400,5200,07KNSTD,0.253863843</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_steps_to_use_reported_snow_shielding">5.1.1. Steps to use reported snow shielding</h4>
<div class="paragraph">
<p>Reported snow shielding values are done on a basin-by-basin basis, so our snow shielding must have individual shielding calculations for each sample.
This is only possible using our "spawning" routines.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The spawning of basins must be performed: see <a href="#_spawning_the_basins">Spawning the basins</a></p>
</li>
<li>
<p>The <code>*_spawned_CRNData.csv</code> should have snow shielding values in the 8th column.</p>
</li>
<li>
<p>A python script, <code>JoinSnowShielding.py</code>, must be run that translates reported snow shielding values into effective depths.
This script, and a required helper script, <code>LSDOSystemTools.py</code>  can be downloaded from:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/JoinSnowShielding.py
$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/LSDOSystemTools.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to scroll to the bottom of the <code>JoinSnowShielding.py</code> program and edit both the path name and the file prefix.
For example, if your spawned data was in <code>/home/ExampleDatasets/SanBernardino/</code> and the files were <code>SanBern_spawned_CRNRasters.csv</code>, <code>SanBern_spawned_CRNData.csv</code>, and <code>SanBern_spawned.CRNParam</code>, then the bottom of the python file should contain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">if __name__ == "__main__":
    path = "/home/ExampleDatasets/SanBernardino"
    prefix = "SanBern_spawned"
    GetSnowShieldingFromRaster(path,prefix)</code></pre>
</div>
</div>
</li>
<li>
<p>This script will then modify the <code>*spawned_CRNRasters.csv</code> so that the second column will have an effective snow shiedling reflecting the reported snow shielding value
(converted using the equation earlier in this section). It will print a new file, <code>*spawned_SS_CRNRasters.csv</code> and copy the CRNData and CRNParam files to ones with prefixes:
<code>*_spawned_SS_CRNData.csv</code> and <code>*_spawned_SS.CRNParam</code>.</p>
</li>
<li>
<p>These new files (with <code>_SS</code> in the prefix) will then be used by the erosion rate calculator.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assign_a_single_effective_average_depth">5.2. Assign a single effective average depth</h3>
<div class="paragraph">
<p>This option assumes that there is a uniform layer of time-averaged snow thickness over the entire basin.
The thickness reported is in effective depth (g cm<sup>-2</sup>).</p>
</div>
<div class="paragraph">
<p>To assign a constant thickness, one simply must set the section column of <code>*_CRNRasters.csv</code> file to the appropriate effective depth.</p>
</div>
<div class="paragraph">
<p>For example, a file might look like:</p>
</div>
<div class="listingblock">
<div class="title">An example CRNRasters.csv file with constant snow shielding</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">/home/topodata/SanBern,15
/home/topodata/Sierra,15,0
/home/topodata/Ganga,15,0,/home/topodata/Ganga_shielded</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example the first row just sets a constant effective depth of 15  g cm<sup>-2</sup>,
The second also assigns a self shielding value of 0 g cm<sup>-2</sup> (which happens to be the default),
and the third row additionally identifies a topographic shielding raster.</p>
</div>
<div class="paragraph">
<p>In general, assigning a constant snow thickness over the entire DEM is not particularly realistic,
and it is mainly used to approximate the snow shielding reported by other authors when they have not made the spatially distributed data about snow thicknesses available
see <a href="#_using_previously_reported_snow_shielding">Using previously reported snow shielding</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pass_a_raster_of_effective_average_depth_of_snow_over_a_catchment">5.3. Pass a raster of effective average depth of snow over a catchment</h3>
<div class="paragraph">
<p>Our software also allows users to pass a raster of effective snow thicknesses (g cm<sup>-2</sup>).
This is the time-averaged effective thickness of snow which can be spatially heterogeneous.</p>
</div>
<div class="paragraph">
<p>The raster is given in the second column of the <code>*_CRNRasters.csv</code>, so, for example in the below file the 4th and 6th rows point to snow shielding rasters.</p>
</div>
<div class="listingblock">
<div class="title">An example CRNRasters.csv file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">/home//basin_data/Site01/Site01_DEM,0,0,/home/basin_data/Site01/Site01_DEM_TopoShield
/home/basin_data/Site02/Site02_DEM,5,10
/home/basin_data/Site03/Site03_DEM,5,/home/basin_data/Site03/Site03_DEM_SelfShield
/home/basin_data/Site04/Site04_DEM,/home/basin_data/Site04/Site04_DEM_SnowShield,/home/basin_data/Site04/Site04_DEM_SelfShield
/home/basin_data/Site05/Site05_DEM
/home/basin_data/Site06/Site06_DEM,/home/basin_data/Site06/Site06_DEM_SnowShield</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The snow shielding raster must be the same size and shape as the underlying DEM
(i.e. they must have the same number of rows and columns, same coordinate system and same data resolution).
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
These rasters need to be assigned <strong>BEFORE</strong> spawning since the spawning process will clip the snow rasters to be the same size as the clipped topography for each basin.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_compute_snow_shielding_from_snow_water_equivalent_data">5.4. Compute snow shielding from snow water equivalent data</h3>
<div class="paragraph">
<p>In some cases you might have to generate the snow shielding raster yourself. We have prepared some python scripts and some C++ programs that allow you to do this.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, you need to gather some data. You can get the data from <a href="http://www.wcc.nrcs.usda.gov/snow/snotel-wedata.html">snow observations</a>, or from <a href="https://nsidc.org/data/nsidc-0271">reconstructions</a>. The simple functions we have prepared simply approximate snow water equivalent (SWE) as a function of elevation.</p>
</li>
<li>
<p>You need to take your study area, and prepare a file that has two columns, seperated by a space.
The first column is the elevation in metres, and the second column is the average annual snow water equivalent in mm.
Here is an example from Idaho:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">968.96	70.58333333
1211.2	16
1480.692	51.25
1683.568	165.8333333
1695.68	115.4166667
1710.82	154.1666667
1877.36	139.75
1925.808	195.1666667
1974.256	277.75
2240.72	253.0833333
2404.232	241.5833333
2395.148	163.0833333</code></pre>
</div>
</div>
</li>
<li>
<p>Once you have this file, download the following python script from our repository:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide/raw/master/SnowShieldFit.py</code></pre>
</div>
</div>
</li>
<li>
<p>Open the python file and change the filenames to reflect the name of your data file withing the python script, here (scroll to the bottom):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">if __name__ == "__main__":

    # Change these names to create the parameter file.  The first line is the name
    # of the data file and the second is the name of the parameter file
    filename = 'T:\\analysis_for_papers\\Manny_idaho\\SWE_idaho.txt'
    sparamname = 'T:\\analysis_for_papers\\Manny_idaho\\HarringCreek.sparam'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script will fit the data to a bilinear function, shown to approximate the SWE distribution with elevation in a number of sites. You can read about the bilinear fit in a paper by <a href="http://www.hydrol-earth-syst-sci.net/18/4261/2014/hess-18-4261-2014.html">Kirchner et al., HESS, 2014</a> and by
<a href="http://www.the-cryosphere.net/8/2381/2014/">Grünewald et al., Cryosphere, 2014</a>.</p>
</div>
<div class="paragraph">
<p>For reasons we will see below the prefix (that is the pit before the <code>.sparam</code>) should be the same as the name of the elevation DEM upon which the SWE data will be based.</p>
</div>
</li>
<li>
<p>Run the script with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ python SnowShieldFit.py</code></pre>
</div>
</div>
</li>
<li>
<p>This will produce a file with the extension sparam. The .sparam file contains the slope and intercept for the annual average SWE for the two linear segments, but in units of g cm<sup>-2</sup>.
These units are to ensure the snow water equivalent raster is in units compatible with effective depths for cosmogenic shielding.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The data file you feed in to <code>SnowShieldFit.py</code> should have SWE in mm, whereas the snow shielding raster will have SWE in effective depths with units g cm<sup>-2</sup>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Okay, we can now use some C++ code to generate the snow shielding raster. If you cloned the repository (using <code>git clone <a href="https://github.com/LSDtopotools/LSDTopoTools_AnalysisDriver.git" class="bare">https://github.com/LSDtopotools/LSDTopoTools_AnalysisDriver.git</a></code>), you will have a function for creating a snow shielding raster. Navigate to the <code>driver_functions</code> folder and make the program using:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f SimpleSnowShield.make</code></pre>
</div>
</div>
</li>
<li>
<p>You run this program with two arguments. The first argument is the path to the <code>.sparam</code> file that was generated by the script <code>SnowShieldFit.py</code>. The path <strong>MUST</strong> include a final slash (i.e. <code>/home/a/directory/</code> will work but <code>/home/a/directory</code> will fail.)
The second argument is the prefix of the elevation DEM <strong>AND</strong> the <code>.sparam</code> file (i.e. if the file is <code>HarringCreek.sparam</code> then the prefix is <code>HarringCreek</code>). The code will then print out an <code>bil</code> format raster with the prefix plus <code>_SnowBL</code> so for example if the prefix is <code>HarringCreek</code> then the output raster is <code>HarringCreek_SnowBL.bil</code>. The command line would look something like:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The prefix of the <code>.sparam</code> file <strong>MUST</strong> be the same as the DEM prefix.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Congratulations! You should now have a snow shielding raster that you can use in your CRN-based denudation rate calculations.
NOTE: The program <code>SimpleSnowShield.exe</code> can also produce SWE rasters using a modified Richard&#8217;s equation, which has been proposed by
<a href="http://onlinelibrary.wiley.com/doi/10.1002/2015GL063413/epdf">Tennent et al., GRL</a>, but at the moment we do not have functions that fit
SWE data to a Richard&#8217;s equation so this is only recommended for users with pre-calculated parameters for such equations.</p>
</li>
<li>
<p>If you have performed this step after spawning the DEMs (see the section <a href="#_spawning_the_basins">Spawning the basins</a>), you can update the <code>_CRNRasters.csv</code> by running the python script <code>PrepareCRNRastersFileFromDirectory.py</code>, which you can read about in the section: <a href="#_modifying_your_crnrasters_file_the_python_way">Modifying your CRNRasters file the python way</a>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calculating_denudation_rates">6. Calculating denudation rates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Okay, now you are ready to get the denudation rates.
You&#8217;ll need to run the function from the directory where the compiled code is located
(in our example, <code>/home/LSDTT_repositories/LSDTopoTools_CRNBasinwide/</code>), but it can work on data in some arbitrary location.</p>
</div>
<div class="sect2">
<h3 id="_compiling_the_code">6.1. Compiling the code</h3>
<div class="paragraph">
<p>To compile the code, go to the driver function folder
(in the example, <code>/home/LSDTT_repositories/LSDTopoTools_CRNBasinwide/driver_functions_CRNBasinwide</code>)
and type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Basinwide_CRN.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will result in a program called <strong>Basinwide_CRN.exe</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_basin_averaged_denudation_rate_calculator">6.2. Running the basin averaged denudation rate calculator</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Basinwide_CRN.exe pathname_of_data file_prefix method_flag</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The pathname_of_data is just the path to where your data is stored, in this example that is
<code>/home/ExampleDatasets/SanBernardino/</code>.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You <strong>MUST</strong> remember to put a <code>/</code> at the end of your pathname.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The filename is the <strong>PREFIX</strong> of the files you need for the analysis (that is, without the extension).</p>
<div class="ulist">
<ul>
<li>
<p>In the example this prefix is <code>SanBern</code>.</p>
</li>
<li>
<p>If you want to use the spawned basins used <code>SanBern_Spawned</code>.</p>
</li>
<li>
<p>If you spawned basins and calculated shielding the prefix is <code>SanBern_spawned_Shield</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>method_flag</code> tells the program what method you want to use to calculate erosion rates. The options are:</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Method flag options</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A basic analysis that does not include any shielding (i.e., no topographic, snow or self shielding).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An analysis that includes shielding, but does not account for spawning (see <a href="#_spawning_the_basins">Spawning the basins</a> for details on spawning).
<strong>If this option is used on spawned basins it is likely to result in errors</strong>. Note that spawning speeds up calculations if you have multiple processors at your disposal, but</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An analyis that includes shielding, to be used on spawned basins (see <a href="#_spawning_the_basins">Spawning the basins</a> for details on spawning). This is the default.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_the_output_files">6.3. The output files</h3>
<div class="paragraph">
<p>There are two output files. Both of these files will end up in the <code>pathname</code> that you designated when calling the program.</p>
</div>
<div class="paragraph">
<p>The first is called <code>file_prefix_CRNResults.csv</code> and the second is called <code>file_prefix_CRONUSInput.txt</code>
where file_prefix is the prefix you gave when you called the program.</p>
</div>
<div class="paragraph">
<p>So, for example, if you called the program with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./basinwide_CRN.exe /home/ExampleDatasets/SanBernardino/ SanBern</code></pre>
</div>
</div>
<div class="paragraph">
<p>The outfiles will be called:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">SanBern_CRNResults.csv
SanBern_CRONUSInput.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>_CRONUSInput.txt</code> is formatted to be cut and pasted directly into the CRONUS calculator.
The file has some notes (which are pasted into the top of the file):</p>
</div>
<div class="listingblock">
<div class="title">Header of the *_CRONUSInput.txt file</div>
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">-&gt;IMPORTANT nuclide concentrations are not original!
      They are scaled to the 07KNSTD!!
-&gt;Scaling is averaged over the basin for snow, self and topographic shielding.
-&gt;Snow and self shielding are considered by neutron spallation only.
-&gt;Pressure is an effective pressure that reproduces Stone scaled production
      that is calculated on a pixel by pixel basis.
-&gt;Self shielding is embedded in the shielding calculation and so
      sample thickness is set to 0.</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You should only paste the contents of the file below the header into the CRONUS calculator, which can be found here:
<a href="http://hess.ess.washington.edu/math/al_be_v22/al_be_erosion_multiple_v22.php" class="bare">http://hess.ess.washington.edu/math/al_be_v22/al_be_erosion_multiple_v22.php</a>
A new version of the CRONUS caluclator should be available late 2016 but should be backward compatible with the prior version. See here:
<a href="http://hess.ess.washington.edu/math/index_dev.html" class="bare">http://hess.ess.washington.edu/math/index_dev.html</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>_CRNResults.csv</code> is rather long.
It contains the following data in comma separated columns:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Columns in the <code>_CRNResults.csv</code> file</caption>
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 72.7273%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Units</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">basinID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique identifier for each CRN sample.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sample_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the sample</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nuclide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the nuclide. Must be either <code>10Be</code> or <code>26Al</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal degrees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latitude.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">longitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal degrees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The longitude.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">concentration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">atoms/g</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concentration of the nuclide. This is adjusted for the recent standard (e.g., 07KNSTD),
so it may not be the same as in the original dataset.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">concentration_uncert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">atoms/g</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The concentration uncertainty of the nuclide.
Most authors report this as only the AMS uncertainty.
The concentration is adjusted for the recent standard (e.g., 07KNSTD),
so it may not be the same as in the original dataset.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erosion rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate in mass per unit area: this is from the full spatially distributed
erosion rate calculator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erosion rate AMS_uncert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate uncertainty in mass per unit area: this is from the full spatially distributed
erosion rate calculator. The uncertainty is only that derived from AMS uncertainty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">muon_uncert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate uncertainty in mass per unit area derived from muon uncertainty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">production_uncert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate uncertainty in mass per unit area derived from uncertainty in the production rate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">total_uncert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate uncertainty in mass per unit area that combines all uncertainties.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AvgProdScaling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average production scaling correction for the basin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AverageTopoShielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average topographic shielding correction for the basin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AverageSelfShielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average self shielding correction for the basin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AverageSnowShielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average snow shielding correction for the basin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AverageShielding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average of combined shielding. Used to emulate basinwide erosion for CRONUS. CRONUS takes separate topographic, snow and self shielding values, but our code calculates these using a fully depth integrated approach so to convert our shielding numbers for use in CRONUS we lump these together to be input as a single shielding value in CRONUS.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AvgShield_times_AvgProd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average of combined shielding times production. This is for use in emulating the way CRONUS assimilates data, since it CRONUS calculates shielding and production separately.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AverageCombinedScaling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (dimensionless)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The average combined shielding and scaling correction for the basin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outlet_latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal degrees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latitude of the basin outlet. This can be assumed to be in <a href="http://spatialreference.org/ref/epsg/wgs-84/">WGS84 geographic coordinate system</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OutletPressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hPa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pressure of the basin outlet (calculated based on NCEP2 data after CRONUS).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OutletEffPressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hPa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pressure of the basin outlet (calculated based on NCEP2 data after CRONUS) needed to get the production scaling at the outlet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">centroid_latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal degrees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latitude of the basin centroid. This can be assumed to be in <a href="http://spatialreference.org/ref/epsg/wgs-84/">WGS84 geographic coordinate system</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">centroidPressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hPa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pressure of the basin centroid (calculated based on NCEP2 data after CRONUS).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CentroidEffPressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hPa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the pressure needed to get basin averaged production scaling:
it is a means of translating the spatially distributed production data into a single value for the CRONUS calculator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">26</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eff_erate_COSMOCALC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate you would get if you took production weighted scaling and used
cosmocalc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">27</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erate_COSMOCALC_mmperkyr_rho2650</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm kyr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate you would get if you took production weighted scaling and used
cosmocalc. Assumes \(/rho\) = 2650 kg m<sup>-3</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">28</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eff_erate_COSMOCALC_emulating_CRONUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">g cm<sup>-2</sup> yr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The erosion rate if you calcualte the average shielding and scaling separately (as done in CRONUS) but erosion rate is caluclated using COSMOCALC. Assumes \(/rho\) = 2650 kg m<sup>-3</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erate_COSMOCALC_emulating_CRONUS_mmperkyr_rho2650</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm kyr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in the erosion rate. Assumes 2650 kg m<sup>-2</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erate_mmperkyr_rho2650</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm kyr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the erosion rate calculated by our full calculator in mm kyr<sup>-1</sup> assuming \(/rho\) = 2650 kg m<sup>-3</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erate_totalerror_mmperkyr_rho2650</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm kyr<sup>-1</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in the erosion rate using the full calculator. Assumes \(/rho\) = 2650 kg m<sup>-3</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">basin_relief</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relief of the basin. Because production scales nonlinearly with elevation,
it is likeley that errors in erosion rates arising from not calculating production on a pixel-by-pixel basis will correlate with relief.
In addition, higher relief areas will have greater topographic shielding,
so prior reported results that used either no topographic shielding or low resoltion topographic shielding are likeley to have greater errors.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_reducing_the_output_data">6.3.1. Reducing the output data</h4>
<div class="paragraph">
<p>Users may wish to reduce the data contained within <code>_CRNResults.csv</code> file, so we provide python scripts for doing so.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nested_basins">6.4. Nested basins</h3>
<div class="paragraph">
<p>Frequently field workers sample drainage basins that are nested within other basins.
We can use denudation rate data from nested basins to calculate the denudation rate required from the remainder of the basin to arrive at the measured CRN concentrations.</p>
</div>
<div class="paragraph">
<p>Our repository contains a function that allows calculation of CRN-derived denudation rates given a mask of known denudation rates. We refer to it as a nesting calculator because we expect this to be its primary use, but because the program takes a known erosion rate raster the known denudation rate data can take any geometry and one can have spatially heterogeneous known denudation rates.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you have checked out the <a href="https://github.com/LSDtopotools/LSDTopoTools_CRNBasinwide">repository</a>, you can make the nesting driver with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Nested_CRN.make</code></pre>
</div>
</div>
</li>
<li>
<p>To run the code, you need a path and a file prefix, just as in with the <code>Basinwide_CRN.exe</code>. The path <strong>MUST</strong> include a trailing slash (e.g., <code>/home/a/directory/</code> and <strong>NOT</strong> <code>/home/a/directory</code>), and the prefix should point to the <code>_CRNRasters.csv</code>, <code>_CRNData.csv</code>, and <code>.CRNparam</code> files. If any of these files are missing from the directory that is indicated in the path argument the code will not work.</p>
<div class="paragraph">
<p>An example call to the program might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Nested_CRN.exe /path/to/data/ My_prefix</code></pre>
</div>
</div>
</li>
<li>
<p>For each raster listed in the directory indicated by the path, the <code>Nested_CRN</code> program will look for a raster with the same prefix but with the added string <code>_ERKnown</code>. You <strong>MUST</strong> have this exact string in the filename, and it is case sensitive. So for example if your raster name is <code>HarringCreek.bil</code> the know denudation rate raster must be names <code>HarringCreek_ERKnown.bil</code>.</p>
</li>
<li>
<p>The denudation rate raster <strong>MUST</strong> be in units of g cm<sup>-2</sup> yr<sup>-1</sup>. This raster <strong>MUST</strong> be the same size as the elevation raster.</p>
</li>
<li>
<p>The data outputs will be the same as in the case of the <code>Basinwide_CRN.exe</code> program.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_how_do_i_make_an_erknown_raster">6.4.1. How do I make an _ERKnown raster?</h4>
<div class="paragraph">
<p>We leave it up to the user to produce an <code>_ERKnown</code> raster, but we do have some scripts that can make this a bit easier.</p>
</div>
<div class="paragraph">
<p>We have made a small python package for manipulating raster data called <code>LSDPlottingTools</code>. You can get it in its very own github repository: <a href="https://github.com/LSDtopotools/LSDMappingTools" class="bare">https://github.com/LSDtopotools/LSDMappingTools</a>, which you can clone (into a seperate folder if I were you) with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git clone https://github.com/LSDtopotools/LSDMappingTools.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have cloned that folder, you should also get the <code>LSDOSystemTools.py</code> scripts using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/LSDAutomation/raw/master/LSDOSystemTools.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have these python scripts, you can take a basin mask (these are generated by <code>Basinwide_CRN.exe</code>) if the option <code>write_basin_index_raster:</code>
is set to <code>True</code> in the <code>.CRNParam</code> file and call the module from the LSDPlottingTools package <code>SetToConstantValue</code>.</p>
</div>
<div class="paragraph">
<p>For example, you should have a directory that contains the subdirectory <code>LSDPlottingTools</code> and the script <code>LSDOSystemTools.py</code>. Within the directory you could write a small python script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import LSDPlottingTools as LSDP

def ResetErosionRaster():
    DataDirectory = "T://basin_data//nested//"
    ConstFname = "ConstEros.bil"
    NewErateName = "HarringCreek_ERKnown.bil"
    ThisFile = DataDirectory+ConstFname
    NewFilename = DataDirectory+NewErateName

    LSDP.CheckNoData(ThisFile)

    # now print the constant value file
    constant_value = 0.0084
    LSDP.SetToConstantValue(ThisFile,NewFilename,constant_value)

    LSDP.CheckNoData(NewFilename)

if __name__ == "__main__":
    #fit_weibull_from_file(sys.argv[1])
    #TestNewMappingTools2()
    #ResetErosionRaster()
    #FloodThenHillshade()
    FixStupidNoData()</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script resets any raster data that is not <code>NoData</code> to the value denoted by <code>constant_value</code> so cannot produce spatially heterogeneous denudation rates: for that you will need to write your own scripts.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soil_or_point_data">6.5. Soil or point data</h3>
<div class="paragraph">
<p>CAIRN is also capable of calculating the denudation rates from soil or point samples. Online calculators such as the <a href="http://hess.ess.washington.edu/">CRONUS calculator</a> can calculate denudation rates at a single site but some users who have both basinwide and soil sample may wish to calculate both denudation rates with CAIRN for consistency.</p>
</div>
<div class="paragraph">
<p>The user inputs and outputs for the soil samples are similar to thos of the basin average scripts.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>_CRNRasters.csv</code> file should have the same format as for basinwide samples.</p>
</li>
<li>
<p>The <code>_CRNData.csv</code> file should have the same format as for basinwide samples.</p>
</li>
<li>
<p>The <code>.CRNParam</code> file should have the same format as for basinwide samples</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, and additional file is needed with the extention <code>_CRNSoilInfo.csv</code>. This file needs to have the same prefix as the other parameter files.
The format of this file is:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Columns in the <code>_CRNSoilInfo.csv</code> file</caption>
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 9.0909%;">
<col style="width: 72.7273%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Units</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sample_top_depth_cm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The sample names need to be the same as in the <code>_CRNData.csv</code> file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sample_top_depth_cm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The depth of the top of the sample in cm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sample_bottom_depth_cm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The depth of the bottom of the sample in cm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">density_kg_m3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg m<sup>-3</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The density of the sample. Note that this assumes that everything above the sample is the same density. These are converted into effective depths so if denisty is varying users should use some default denisty (e.g., 2000 kg m<sup>-2</sup>) and then enter depths in cm the, when multiplied by the density, will result in the correct effective depth.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">sample_name,sample_top_depth_cm,sample_bottom_depth_cm,density_kg_m3
S1W-Idaho,0,2,1400
S2W-Idaho,0,2,1400
S3W-Idaho,0,2,1400</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the soil calculator, you need to compile the soil calculator that is include in the repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f Soil_CRN.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then run the code including the path name and the prefix of the data files, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./Soil_CRN.exe /home/smudd/SMMDataStore/analysis_for_papers/Manny_idaho/Revised/Soil_Snow/ HarringCreek_Soil_SnowShield</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-07-24 12:38:49 BST
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>