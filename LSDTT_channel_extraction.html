<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Fiona J. Clubb and Simon M Mudd, School of GeoSciences, University of Edinburgh">
<title>User guide to channel extraction using LSDTopoTools</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>User guide to channel extraction using LSDTopoTools</h1>
<div class="details">
<span id="author" class="author">Fiona J. Clubb and Simon M Mudd, School of GeoSciences, University of Edinburgh</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_get_the_code_for_channel_extraction">2. Get the code for channel extraction</a>
<ul class="sectlevel2">
<li><a href="#_installation_of_the_channel_extraction_algorithms">2.1. Installation of the channel extraction algorithms</a></li>
<li><a href="#_example_datasets">2.2. Example datasets</a>
<ul class="sectlevel3">
<li><a href="#_get_the_test_data">2.2.1. Get the test data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_the_channel_extraction_tool">3. The Channel Extraction tool</a>
<ul class="sectlevel2">
<li><a href="#_starting_up_lsdtopotools_and_getting_the_channel_extraction_tool">3.1. Starting up LSDTopoTools and getting the channel extraction tool</a>
<ul class="sectlevel3">
<li><a href="#_running_a_typical_lsdtt_channel_extraction_analysis">3.1.1. Running a typical lsdtt-channel-extraction analysis</a></li>
</ul>
</li>
<li><a href="#_first_example_of_channel_extraction">3.2. First Example of channel extraction.</a></li>
<li><a href="#_more_complex_channel_extraction">3.3. More complex channel extraction</a>
<ul class="sectlevel3">
<li><a href="#_switching_on_the_high_resolution_extraction_methods">3.3.1. Switching on the high resolution extraction methods</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_calculating_drainage_density">4. Calculating drainage density</a>
<ul class="sectlevel2">
<li><a href="#_get_the_code_for_drainage_density_analysis">4.1. Get the code for drainage density analysis</a>
<ul class="sectlevel3">
<li><a href="#_clone_the_github_repository">4.1.1. Clone the GitHub repository</a></li>
<li><a href="#_alternatively_get_the_zipped_code">4.1.2. Alternatively, get the zipped code</a></li>
<li><a href="#_get_the_example_datasets">4.1.3. Get the example datasets</a></li>
<li><a href="#_get_the_example_parameter_files">4.1.4. Get the example parameter files</a></li>
<li><a href="#_python_scripts">4.1.5. Python scripts</a></li>
</ul>
</li>
<li><a href="#_preliminary_steps">4.2. Preliminary steps</a>
<ul class="sectlevel3">
<li><a href="#_getting_the_channel_head_file">4.2.1. Getting the channel head file</a></li>
<li><a href="#_selecting_a_window_size">4.2.2. Selecting a window size</a></li>
</ul>
</li>
<li><a href="#_analysing_drainage_density_for_all_basins">4.3. Analysing drainage density for all basins</a>
<ul class="sectlevel3">
<li><a href="#_creating_the_paramter_file">4.3.1. Creating the paramter file</a></li>
<li><a href="#_step_1_get_the_junctions_of_all_the_basins">4.3.2. Step 1: Get the junctions of all the basins</a></li>
<li><a href="#_step_2_get_the_drainage_density_of_each_basin">4.3.3. Step 2: Get the drainage density of each basin</a></li>
<li><a href="#_step_3_plotting_the_data">4.3.4. Step 3: Plotting the data</a></li>
<li><a href="#_summary">4.3.5. Summary</a></li>
</ul>
</li>
<li><a href="#_analysing_drainage_density_for_basins_with_crn_derived_erosion_rates">4.4. Analysing drainage density for basins with CRN-derived erosion rates</a>
<ul class="sectlevel3">
<li><a href="#_formatting_your_erosion_rate_data">4.4.1. Formatting your erosion rate data</a></li>
<li><a href="#_creating_the_paramter_file_2">4.4.2. Creating the paramter file</a></li>
<li><a href="#_step_1_run_the_code">4.4.3. Step 1: Run the code</a></li>
<li><a href="#_step_2_plot_the_data">4.4.4. Step 2: Plot the data</a></li>
<li><a href="#_summary_2">4.4.5. Summary</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_channel_extraction_parameter_file_options">Appendix A: Channel extraction parameter file options</a>
<ul class="sectlevel2">
<li><a href="#_channel_extraction_options">A.1. Channel extraction options</a></li>
</ul>
</li>
<li><a href="#_channel_extraction_file_formats">5. Channel extraction file formats</a>
<ul class="sectlevel2">
<li><a href="#_channel_sources_files">5.1. Channel sources files</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="index.html">Return to main <strong>LSDTopoTools</strong> landing page</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_so_wiener.png" alt="An extracted channel network">
</div>
<div class="title">Figure 1. An extracted channel network</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Before you start</div>
<div class="paragraph">
<p>Before you start you need to install <strong>LSDTopoTools</strong>. If you haven&#8217;t done that, please follow the link below.</p>
</div>
<div class="paragraph">
<p><a href="LSDTT_installation.html">Instructions on how to install LSDTopoTools</a></p>
</div>
<div class="paragraph">
<p>In addition, you will need to use some basic linux shell commands. If you have never done this before I suggest reading this brief introduction: <a href="LSDTT_using_linux.html">Basic use of the linux shell</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Terrestrial landscapes are almost all dissected by channels. Mapping channels and rivers has been a feature of cartography from its start. A few centuries ago, finding river sources use to be <a href="https://en.wikipedia.org/wiki/Nile#Search_for_the_source_of_the_Nile">an amusing way</a>  <a href="https://en.wikipedia.org/wiki/Amazon_River#Origins">to get your name in a newspaper</a>. In fact, there continue to this day to be stunts looking for <a href="http://www.bbc.co.uk/earth/story/20160516-why-it-is-hard-to-find-the-source-of-rivers-like-the-amazon">the source</a> <a href="http://news.bbc.co.uk/1/hi/england/hampshire/4864782.stm">of major rivers</a>.</p>
</div>
<div class="paragraph">
<p>Taking boats through precarious jungles is good fun for some, but in fact we can now use digital topography to look for the characteristic topographic signs of channels on the landscapes using remotely-sensed data. These signs can simply be the "v-shaped" valleys that you might have learned about in school, or could include more advanced techniques. We now have <a href="http://www.eorc.jaxa.jp/ALOS/en/aw3d30/index.htm">topographic</a> <a href="https://www.pgc.umn.edu/data/arcticdem/">data</a> <a href="https://tandemx-science.dlr.de/">covering the</a> <a href="https://asterweb.jpl.nasa.gov/gdem.asp">entire</a> <a href="https://www2.jpl.nasa.gov/srtm/">planet</a> so as long ago as 2005 (when the <a href="https://www2.jpl.nasa.gov/srtm/">SRTM 90 dataset was released</a>) it was trivially easy to find the longest channel in a river network.
Knowing in detail where the channel head is, however, is not at all trivial and now that <a href="https://en.wikipedia.org/wiki/Lidar">lidar data</a> is widely available, we can look for topographic signature of channel at scaled approaching those of the actual channel heads.</p>
</div>
<div class="paragraph">
<p>In this documentation we have compiled several methods for determining the location of channel heads using high resolution data, and ported them into <strong>LSDTopoTools</strong>. These algorithms should be, for the most part, accurate to ~20-30 metres of the actual channel head. For details see the following paper:</p>
</div>
<div class="paragraph">
<p><a href="http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/full">Clubb, F. J., S. M. Mudd, D. T. Milodowski, M. D. Hurst, and L. J. Slater (2014), Objective extraction of channel heads from high-resolution topographic data, <em>Water Resour. Res.</em>, <strong>50</strong>, 4283â€“4304, doi:10.1002/2013WR015167.</a></p>
</div>
<div class="paragraph">
<p>We have also attempted to quantify the resolution of data needed for the different methods; the answer is that you <em>might</em> be able to extract a reasonable channel network from 10 metres resolution data, but 30 metre resolution data is not trustworthy. If you have lidar data, use that. The details are contained in the following paper:</p>
</div>
<div class="paragraph">
<p><a href="https://www.earth-surf-dynam.net/4/627/2016/">Grieve, S. W. D., Mudd, S. M., Milodowski, D. T., Clubb, F. J., and Furbish, D. J.: How does grid-resolution modulate the topographic expression of geomorphic processes?, <em>Earth Surf. Dynam.</em>, <strong>4</strong>, 627-653, https://doi.org/10.5194/esurf-4-627-2016, 2016.</a></p>
</div>
<div class="paragraph">
<p>For completeness we include our historic functions for calculating channel sources, but in general the only tool you will need is <a href="#_the_channel_extraction_tool">The Channel Extraction tool</a>. We also refer readers to the <a href="https://sites.google.com/site/geonethome/home">GeoNet channel extraction tool</a>, which was developed by Paola Passalacqua and colleagues.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_the_code_for_channel_extraction">2. Get the code for channel extraction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Channel extraction is included within the <strong>LSDTopoTools</strong> package.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Quickstart installation</div>
<div class="paragraph">
<p>If you have installed <strong>LSDTopoTools</strong> before, or are familair with Docker, here are very quick instructions.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Docker</p>
</li>
<li>
<p>Make a directory to hold all your <strong>LSDTopoTools</strong> code and data.</p>
</li>
<li>
<p>Pull and start the LSDTopoTools container (in the below command it assumes you have put your <strong>LSDTopoTools</strong> directory in <code>C:/LSDTopoTools</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ docker run --rm -it -v C:/LSDTopoTools:/LSDTopoTools lsdtopotools/lsdtt_pcl_docker</code></pre>
</div>
</div>
</li>
<li>
<p>In the docker container, run the script <code>Start_LSDTT.sh</code></p>
</li>
<li>
<p>You are ready to go!</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installation_of_the_channel_extraction_algorithms">2.1. Installation of the channel extraction algorithms</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Good news! If you have installed <strong>LSDTopoTools</strong>, you already have the channel extraction tools.</p>
</li>
<li>
<p>In you haven&#8217;t installed it, follow the <a href="LSDTT_installation">LSDTopoTools installation instructions</a>.</p>
</li>
<li>
<p>The channel extraction code is called <code>lsdtt-channel-extraction</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_example_datasets">2.2. Example datasets</h3>
<div class="paragraph">
<p>We have provided some example datasets which you can use in order to test the channel extraction algorithms. In this tutorial we will work using a lidar dataset from Indian Creek, Ohio.</p>
</div>
<div class="sect3">
<h4 id="_get_the_test_data">2.2.1. Get the test data</h4>
<div class="paragraph">
<p>If you have followed the <a href="LSDTT_installation.html">installation instructions</a> and grabbed the example data, you already have what you need! If not, follow the steps below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you are using a docker container, just run the script:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># Get_LSDTT_example_data.sh</code></pre>
</div>
</div>
</li>
<li>
<p>If you are on a native linux or using the University of Edinburgh servers, do the following:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you have installed <strong>LSDTopoTools</strong>, you will have a directory somewhere called <code>LSDTopoTools</code>. Go into it.</p>
</li>
<li>
<p>Run the following commands (you only need to do this once):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ mkdir data
$ cd data
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/archive/master.zip
$ unzip master.zip
$ mv ./ExampleTopoDatasets-master ./ExampleTopoDatasets
$ rm master.zip</code></pre>
</div>
</div>
</li>
<li>
<p>WARNING: This downloads a bit over 150Mb of data so make sure you have room.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The datasets for our channel extraction tests are in the subdirectory <code>/LSDTopoTools/data/ExampleTopoDatasets/ChannelExtractionData</code> in the Docker container.</p>
</div>
<div class="paragraph">
<p>There are several datasets within this directory, for the initial tutorial we will focues on the Indan Creek, Ohio DEM. It is in the subdirectory <code>IndianCreek_1m</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_map.png" alt="Shaded relief map of Indian Creek">
</div>
<div class="title">Figure 2. Shaded relief image of Indian Creek catchment, Ohio USA, UTM Zone 17N</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_channel_extraction_tool">3. The Channel Extraction tool</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our channel extraction tool bundles four methods of channel extraction. These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A rudimentary extraction using a drainage area threshold.</p>
</li>
<li>
<p>The <a href="http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract">Dreich method (Clubb et al., 2014)</a>.</p>
</li>
<li>
<p>The <a href="http://onlinelibrary.wiley.com/doi/10.1029/2012WR012452/abstract">Pelletier (2013) method</a>.</p>
</li>
<li>
<p>A geometric method combining elements of <a href="https://sites.google.com/site/geonethome/home">Geonet (Passalacqua et al., 2010)</a> and <a href="http://onlinelibrary.wiley.com/doi/10.1029/2012WR012452/abstract">Pelletier (2013)</a> methods that we developed for <a href="http://www.earth-surf-dynam.net/4/627/2016/esurf-4-627-2016.html">Grieve et al. (2016)</a> and <a href="http://onlinelibrary.wiley.com/doi/10.1002/2015JF003747/full">Clubb et al. (2016)</a> We call this the "Wiener" method (after the <a href="https://en.wikipedia.org/wiki/Wiener_filter">wiener filter</a> used to preprocess the data).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods are run based on a common interface via the program <code>lsdtt-channel-extraction</code>.</p>
</div>
<div class="sect2">
<h3 id="_starting_up_lsdtopotools_and_getting_the_channel_extraction_tool">3.1. Starting up LSDTopoTools and getting the channel extraction tool</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The channel extraction tool (<code>lsdtt-channel-extraction</code>) is included in <strong>LSDTOpoTools</strong>, so if you have installed <strong>LSDTopoTools</strong> you will aready have what you need.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you haven&#8217;t installed <strong>LSDTopoTools</strong>, follow the <a href="LSDTT_installation">LSDTopoTools installation instructions</a>).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Before you do anything, you need to start an <strong>LSDTopoTools</strong> session.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you are using Docker , start the container:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ docker run -it -v C:\LSDTopoTools:/LSDTopoTools lsdtopotools/lsdtt_pcl_docker</code></pre>
</div>
</div>
</li>
<li>
<p>Then run the start script.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># Start_LSDTT.sh</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If you haven&#8217;t got the example data yet, run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># Get_LSDTT_example_data.sh</code></pre>
</div>
</div>
</li>
<li>
<p>If you are using native linux, read the <a href="LSDTT_installation">LSDTopoTools installation instructions</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Like most of <strong>LSDTopoTools</strong>, you run this program by directing it to a parameter file. The parameter file has a series of keywords. Our convention is to place the parameter file in the same directory as your data.</p>
</div>
<div class="sect3">
<h4 id="_running_a_typical_lsdtt_channel_extraction_analysis">3.1.1. Running a typical lsdtt-channel-extraction analysis</h4>
<div class="paragraph">
<p>In the next section we will walk you though an analysis. However, reading this will help you understand where you are going, so we recommend you read the whole thing!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You run the program from a terminal window</p>
</li>
<li>
<p>You can supply the program with:</p>
<div class="ulist">
<ul>
<li>
<p>a directory name</p>
</li>
<li>
<p>a parameter file name</p>
</li>
<li>
<p>both of these things</p>
</li>
<li>
<p>none of these things</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you don&#8217;t supply a parameter filename, the program will assume the parameter file is called <code>LSDTT_parameters.driver</code></p>
</li>
<li>
<p>If the parameter file doesn&#8217;t exist, you will get an error message.</p>
<div class="paragraph">
<p>Any of the following calls to one of the programs will work, as long as your files are in the right place:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ lsdtt-channel-extraction
$ lsdtt-channel-extraction /LSDTopoTools/data/A_project
$ lsdtt-channel-extraction AParameterFile.param
$ lsdtt-channel-extraction /LSDTopoTools/data/A_project AParameterFile.param</code></pre>
</div>
</div>
</li>
<li>
<p>The program name (<code>lsdtt-channel-extraction</code>), the directory name (<code>/LSDTopoTools/data/A_project</code>) and the parameter file name (<code>AParameterFile.param</code>) will change but all <strong>LSDTopoTools</strong> calls follow this same basic structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_first_example_of_channel_extraction">3.2. First Example of channel extraction.</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We are going to extract a channel networks from Indian Creek, a small creek in Ohio. It was using in the study <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2013WR015167">Clubb et al., 2014</a>.</p>
</li>
<li>
<p>Once you have run <code>Start_LSDTT.sh</code> you are ready to run an analysis.</p>
</li>
<li>
<p>Go into the directory containing the Indian Creek DEM. In the Docker container it is here:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># cd /LSDTopoTools/data/ExampleTopoDatasets/ChannelExtractionData/IndianCreek_1m</code></pre>
</div>
</div>
</li>
<li>
<p>Now run the channel extraction code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># lsdtt-channel-extraction IndianCreek_example01.param</code></pre>
</div>
</div>
</li>
<li>
<p>The parameter file looks like this</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile"># These are parameters for the file i/o
read fname: indian_creek
channel heads fname: NULL

# Parameter for filling the DEM
min_slope_for_fill: 0.0001

# Parameters for selecting channels and basins
threshold_contributing_pixels: 1000
print_area_threshold_channels: true

write_hillshade: true</code></pre>
</div>
</div>
</li>
<li>
<p>This will generate a very basic channel network where channels begin where the contributung pixels are greater than the parameter <code>threshold_contributing_pixels</code>.</p>
</li>
<li>
<p>If you set a channel extraction method to true (in this example, <code>print_area_threshold_channels: true</code>), you will get two files:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A file with the extension <code>sources.csv</code>: This has the location of the source pixels. We describe the file format below.</p>
</li>
<li>
<p>A file with the extension <code>CN.scv</code>: This contains the channel network, along with the Strahler order of the channels.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If you want to know the file formats, please see the <a href="#channel extraction appendix for file formats">[channel extraction appendix for file formats]</a></p>
</li>
<li>
<p>In addition, we set <code>write_hillshade: true</code>, so we also get a hillshare raster, denoted by the <code>HS</code> in the filename.</p>
</li>
<li>
<p>The channel networks and sources are in csv format, which foes not retain georeferencing information. That means, when you load it into a GIS, you will need to tell the link:LSDTT_QGIS.html#_another_special_case_csv_data_from_lsdtopotools
[GIS what projection you are using].</p>
</li>
<li>
<p>If you want a file that can be directly read into a GIS, then use the parameter <code>convert_csv_to_geojson: true</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The figure below shows the extracted channel network for the Indian Creek field site with a threshold of 1000 pixels (which works out to 1000 m<sup>2</sup> because it is a 1 m resolution DEM).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_so_area.png" alt="Map of Indian Creek with channel network extracted from threshold area">
</div>
<div class="title">Figure 3. Map of Indian Creek with channel network extracted from threshold area</div>
</div>
</div>
<div class="sect2">
<h3 id="_more_complex_channel_extraction">3.3. More complex channel extraction</h3>
<div class="paragraph">
<p>For higher-resolution DEMs a number of different methods have been developed to extract channel networks more accurately.  This section details how to extract channels using methods relying on geometric signatures of channel incision, primarily how it affects planform curvature. Although many methods have been developed that use a variety of planform curvature to detect channel heads from high resolution topogrpahy (e.g., <a href="https://sites.google.com/site/geonethome/home">GeoNet</a>, which was developed by Paola Passalacqua and colleagues) , we will use the three methods available in <code>lsdtt-channel-extraction</code></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. High resolution channel extraction methods includes in <code>lsdtt-channel-extraction</code></caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">paramter file keyword</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pelletier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print_pelletier_channels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A method developed by Pelletier (2013) and implemented in <strong>LSDTopoTools</strong> that uses spectral filtering and tangential curvature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wiener</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print_wiener_channels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A method that combines some elements of the Pelletier method and some of the GeoNet method that is available within <strong>LSDTopoTools</strong>. It was described by <a href="https://www.earth-surf-dynam.net/4/627/2016/">Grieve et al., ESURF, 2016</a>. In that study it was found to be the least sensitive to grid resolution. We call this the <a href="https://en.wikipedia.org/wiki/Wiener_filter">Wiener method</a> since it is based on a Wiener spectral filter (the Pelletier method also uses this filter).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Driech</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>print_dreich_channels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract">Dreich method</a>
that aims to find channel heads by looking at the break in the properties of topographic profiles
that occur when fluvial incision gives way to hillslope sediment transport processes. It is different from the geometric methods described above in that it looks for a theoretical signal of fluvial incision rather than the planform curvature of the landscape.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The method you use should be chosen based on the particular aims of your study: if you only want a single channel network we suggest the Wiener method (see <a href="https://www.earth-surf-dynam.net/4/627/2016/">Grieve et al., ESURF, 2016</a> and <a href="http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract">Clubb et al., WRR, 2014</a>), but because the <a href="http://onlinelibrary.wiley.com/doi/10.1002/2013WR015167/abstract">Dreich method</a> takes a totally different aproach to identifying channels it can be useful to compare the networks generated by these two methods to get an estimate of the uncertainty in the network extent.</p>
</div>
<div class="sect3">
<h4 id="_switching_on_the_high_resolution_extraction_methods">3.3.1. Switching on the high resolution extraction methods</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We are staying at Indian Creek. However, this time you will run the second parameter file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># lsdtt-channel-extraction IndianCreek_example02.param</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This takes a lot longer than the threshold area method! It takes around 22 minutes on my laptop.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The parameter file looks like this</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile"># These are parameters for the file i/o
read fname: indian_creek
channel heads fname: NULL

# Parameter for filling the DEM
min_slope_for_fill: 0.0001

# Parameters for selecting channels and basins
threshold_contributing_pixels: 1000
connected_components_threshold: 100
print_area_threshold_channels: false
print_wiener_channels: true
print_pelletier_channels: true
print_dreich_channels: true</code></pre>
</div>
</div>
</li>
<li>
<p>You will get both <code>sources</code> and <code>CN</code> files for each of these methods.</p>
</li>
<li>
<p>The <code>connected_components_threshold</code> is the minimum number of connected pixels to create a channel. 100 is the default and for most applications you can leave this alone.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The figures below show the extracted channel network for the Indian Creek for the three different methods.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_so_pel.png" alt="Map of Indian Creek with channel network extracted from Pelletier algorithm">
</div>
<div class="title">Figure 4. Map of Indian Creek with channel network extracted from Pelletier algorithm</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_so_wiener.png" alt="Map of Indian Creek with channel network extracted from LSDTopoTools geometric algorithm with an Optimal Wiener filter">
</div>
<div class="title">Figure 5. Map of Indian Creek with channel network extracted from LSDTopoTools geometric algorithm with an Optimal Wiener filter</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ind_so_dreich.png" alt="Map of Indian Creek with channel network extracted from DrEICH algorithm">
</div>
<div class="title">Figure 6. Map of Indian Creek with channel network extracted from DrEICH algorithm</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calculating_drainage_density">4. Calculating drainage density</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Drainage density is a fundamental landscape metric which describes the total length of channels in a basin normalised by the basin area, first described by Horton (1945).  In this chapter we describe how to calculate the drainage density and mean hilltop curvature of a specified order of drainage basins (for example, all second order basins). We also include code which will calculate the drainage density of each basin given a list of cosmogenic radionuclide (CRN)-derived erosion rate data. We used this code to examine the relationship between drainage density and erosion rate in our paper published in <a href="http://onlinelibrary.wiley.com/doi/10.1002/2015JF003747/full">JGR Earth Surface</a> in 2016.</p>
</div>
<div class="paragraph">
<p>Citation: Clubb, F. J., S. M. Mudd, M. Attal, D. T. Milodowski, and S. W. D. Grieve (2016), The relationship between drainage density, erosion rate, and hilltop curvature: Implications for sediment transport processes, J. Geophys. Res. Earth Surf., 121, doi:10.1002/2015JF003747.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Quick guide if you already know what you are doing</div>
<div class="paragraph">
<p>Here is a quick overview of how to set up and run the code, if you have done it before:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose the channel extraction method that you would like to use.</p>
</li>
<li>
<p>Make sure your DEM is in <code>bil</code> format and is in the Topographic_projects folder</p>
</li>
<li>
<p>Create a parameter file for your DEM</p>
</li>
<li>
<p>Make sure you have created a channel network for your DEM, and have the <code>_CH</code> file in your repository.</p>
</li>
<li>
<p>Clone the drainage density code: <a href="https://github.com/LSDtopotools/LSDTopoTools_DrainageDensity" class="bare">https://github.com/LSDtopotools/LSDTopoTools_DrainageDensity</a></p>
</li>
<li>
<p>Compile step 1 of the code using <code>make -f drainage_density_step1_junctions.make</code></p>
</li>
<li>
<p>Run step 1 of the program with <code>./drainage_density_step1_junctions.out /path_to_data_folder/ parameter_file.driver</code></p>
</li>
<li>
<p>Compile step 2 of the code using <code>make -f drainage_density_step2_basins.make</code></p>
</li>
<li>
<p>Run step 2 of the code using <code>./drainage_density_step2_basins.out /path_to_data_folder/ parameter_file.driver</code></p>
</li>
<li>
<p>Run the Python scripts to plot the data.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get_the_code_for_drainage_density_analysis">4.1. Get the code for drainage density analysis</h3>
<div class="paragraph">
<p>The code for the drainage density analysis can be found in our GitHub repository.  This repository contains code for extracting the drainage density for a series of basins defined by points from cosmogenic radionuclide samples, as well as the drainage density and mean hilltop curvature for basins of a specified order.</p>
</div>
<div class="sect3">
<h4 id="_clone_the_github_repository">4.1.1. Clone the GitHub repository</h4>
<div class="paragraph">
<p>First navigate to the folder where you will keep the GitHub repository.  If you have downloaded LSDTopoTools using vagrant, then this should be in the folder <code>Git_projects</code>.  Please refer to the <a href="LSDTT_installation.html">documentation on installing LSDTopoTools</a>.  To navigate to this folder in a UNIX terminal use the <code>cd</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/$ cd /LSDTopoTools
vagrant@vagrant-ubuntu-precise-32:/$ cd /Git_projects</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the command <code>pwd</code> to check you are in the right folder.  Once you are in this folder, you can clone the repository from the <a href="https://github.com">GitHub website</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects$ pwd
/LSDTopoTools/Git_projects
vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects$ git clone https://github.com/LSDtopotools/LSDTopoTools_DrainageDensity.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Navigate to this folder again using the <code>cd</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd LSDTopoTools_DrainageDensity/</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_alternatively_get_the_zipped_code">4.1.2. Alternatively, get the zipped code</h4>
<div class="paragraph">
<p>If you don&#8217;t want to use <em>git</em>, you can download a zipped version of the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects$ pwd
/LSDTopoTools/Git_projects
vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects$ wget https://github.com/LSDtopotools/LSDTopoTools_DrainageDensity/archive/master.zip
vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects$ gunzip master.zip</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://github.com">GitHub</a> zips all repositories into a file called <code>master.zip</code>,
so if you previously downloaded a zipper repository this will overwrite it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_example_datasets">4.1.3. Get the example datasets</h4>
<div class="paragraph">
<p>We have provided some example datasets which you can use in order to test the drainage density analysis. In this tutorial we will work using a LiDAR dataset from the Guadalupe Mountains, New Mexico.  This is a clip of the original dataset, which we have resampled to 2 m resolution. The full dataset is available from <a href="http://www.opentopography.org/">OpenTopography.</a>. If you are using the vagrant distribution, create a new folder within the <code>Topographic_projects</code> folder, and then navigate to this folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Topographic_projects$ mkdir Guadalupe_NM
vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Topographic_projects$ cd Guadalupe_NM/</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can get the clip from our ExampleTopoDatasets repository using <code>wget</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/Guadalupe_DEM.bil
$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/raw/master/Guadalupe_DEM.hdr</code></pre>
</div>
</div>
<div class="paragraph">
<p>This dataset is already in the preferred format for use with LSDTopoTools (the ENVI <code>bil</code> format). The figure below shows a shaded relief map of part of the Guadalupe Mountains DEM which will be used in these examples.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Guadalupe_map.png" alt="Shaded relief map of Guadalupe Mountains" width="600" height="400">
</div>
<div class="title">Figure 7. Shaded relief image of the Guadalupe Mountains DEM, NM, USA, UTM Zone 17N</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_example_parameter_files">4.1.4. Get the example parameter files</h4>
<div class="paragraph">
<p>We have also provided some examples parameter files that are used to run the drainage density analysis.  These should be placed in the same folder as your DEM (e.g. in the folder <code>/LSDTopoTools/Topographic_projects/Guadalupe_NM/</code>. You can get the example parameter file using <code>wget</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ wget https://github.com/LSDtopotools/ExampleTopoDatasets/tree/master/example_parameter_files/drainage_density_guadalupe.driver</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_python_scripts">4.1.5. Python scripts</h4>
<div class="paragraph">
<p>We have also provided some Python scripts for creating figures from the draiange density analysis.  These should produce similar figures to those in Clubb et al. (2016), JGR-ES.  These scripts are in the directory <code>Python_scripts</code> within <code>LSDTopoTools_DrainageDensity</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects/LSDTopoTools_DrainageDensity$ cd Python_scripts
vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects/LSDTopoTools_DrainageDensity/Python_scripts$ ls
drainage_density_plot.py	drainage_density_plot_cosmo.py</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_preliminary_steps">4.2. Preliminary steps</h3>
<div class="sect3">
<h4 id="_getting_the_channel_head_file">4.2.1. Getting the channel head file</h4>
<div class="paragraph">
<p>Before the drainage density analysis can be run, you must create a channel network for your DEM.  This can be done using any of the channel extraction algorithms within LSDTopoTools. Once you have run the channel extraction algorithm, you must make sure that the <code>bil</code> and <code>hdr</code> files with the channel head locations are placed in the same folder as the DEM you intend to use for the drainage density analysis.</p>
</div>
</div>
<div class="sect3">
<h4 id="_selecting_a_window_size">4.2.2. Selecting a window size</h4>
<div class="paragraph">
<p>Before we can run the drainage density algorithm, we need to calculate the correct window size for calculating mean hilltop curvature across the DEM.  Please refer to the <a href="LSDTT_hillslope_metrics.html#_selecting_a_window_size">selecting a window size</a> section for information on how to calculate a window size for your DEM.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_analysing_drainage_density_for_all_basins">4.3. Analysing drainage density for all basins</h3>
<div class="paragraph">
<p>This section provides instructions for how to extract the drainage density and mean hilltop curvature for every basin in the landscape of a given order (e.g. all second order drainage basins).</p>
</div>
<div class="sect3">
<h4 id="_creating_the_paramter_file">4.3.1. Creating the paramter file</h4>
<div class="paragraph">
<p>In order to run the drainage density analysis code you must first create a parameter file for your DEM.  This should be placed in the same folder as your DEM and the channel heads <code>bil</code> file.  If you followed the instructions in the <a href="#_get_the_code_for_drainage_density_analysis">Get the code for drainage density analysis</a> section then you will already have an example parameter file for the Guadalupe Mountains DEM called <code>drainage_density_guadalupe.driver</code>.  Parameter files should have the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Name of the DEM without extension
Name of the channel heads file - will vary depending on your channel extraction method
Minimum slope for filling the DEM
Order of basins to extract
Window size (m): calculate for your DEM resolution</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example parameter file for the Guadalupe Mountains DEM is set out below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Guadalupe_DEM
Guadalupe_DEM_CH_DrEICH
0.0001
2
6</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_1_get_the_junctions_of_all_the_basins">4.3.2. Step 1: Get the junctions of all the basins</h4>
<div class="paragraph">
<p>The first step of the analysis creates a text file with all the junction numbers of the basins of the specified stream order.  Before the code can be run, you must compile it using the makefile in the folder <code>LSDTopoTools_DrainageDensity/driver_functions_DrainageDensity</code>.  Navigate to the folder using the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd driver_functions_DrainageDensity/</code></pre>
</div>
</div>
<div class="paragraph">
<p>and compile the code with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f drainage_density_step1_junctions.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>This may come up with some warnings, but should create the file <code>drainage_density_step1_junctions.out</code>. You can then run the program with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./drainage_density_step1_junctions.out /path/to/DEM/location/ name_of_parameter_file.driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>For our example, the command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./drainage_density_step1_junctions.out /LSDTopoTools/Topographic_projects/Guadalupe_NM/ drainage_density_guadalupe.driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>The program will create a text file called <code>DEM_name_DD_junctions.txt</code> which will be ingested by step 2 of the analysis.  It will also create some new rasters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DEM_name_fill: the filled DEM</p>
</li>
<li>
<p>DEM_name_HS: a hillshade of the DEM</p>
</li>
<li>
<p>DEM_name_SO: the channel network</p>
</li>
<li>
<p>DEM_name_JI: the locations of all the tributary junctions</p>
</li>
<li>
<p>DEM_name_CHT: the curvature for all the hilltops in the DEM</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_get_the_drainage_density_of_each_basin">4.3.3. Step 2: Get the drainage density of each basin</h4>
<div class="paragraph">
<p>The second step of the analysis ingests the junctions text file created in step 1. For each junction it will extract the upstream drainage basin, and calculate the drainage density and mean hilltop curvature for the basin.  This will be written to a text file which can be plotted up using our Python script.</p>
</div>
<div class="paragraph">
<p>First, compile the code with the makefile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f drainage_density_step2_basins.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>This may come up with some warnings, but should create the file <code>drainage_density_step2_basins.out</code>. You can then run the program with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./drainage_density_step2_basins.out /path/to/DEM/location/ name_of_parameter_file.driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>For our example, the command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./drainage_density_step2_basins.out /LSDTopoTools/Topographic_projects/Guadalupe_NM/ drainage_density_guadalupe.driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>This program will create 2 text files.  The first one will be called <code>DEM_name_drainage_density_cloud.txt</code> and will have 3 rows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Drainage density of the basin</p>
</li>
<li>
<p>Mean hilltop curvature of the basin</p>
</li>
<li>
<p>Drainage area of the basin</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This text file represents the data for every basin in the DEM.  The second text file will be called <code>DEM_name_drainage_density_binned.txt</code>, where the drainage density and hilltop curvature data has been binned with a bin width of 0.005 m<sup>-1</sup>.  It has 6 rows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Mean hilltop curvature for the bin</p>
</li>
<li>
<p>Standard deviation of curvature</p>
</li>
<li>
<p>Standard error of curvature</p>
</li>
<li>
<p>Drainage density for the bin</p>
</li>
<li>
<p>Standard deviation of drainage density</p>
</li>
<li>
<p>Standard error of drainage density</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These text files are read by <code>drainage_density_plot.py</code> to create plots of the drainage density and mean hilltop curvature.  The code also produces <code>DEM_name_basins.bil</code>, which is a raster with all the basins analysed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_plotting_the_data">4.3.4. Step 3: Plotting the data</h4>
<div class="paragraph">
<p>Navigate to the folder <code>Python_scripts</code> within the <code>LSDTopoTools_DrainageDensity</code> repository.  You should find the following files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects/LSDTopoTools_DrainageDensity/Python_scripts$ ls
drainage_density_plot.py	drainage_density_plot_cosmo.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open the file called <code>drainage_density_plot_cosmo.py</code>.  We suggest doing this on your host machine rather than the virtual machine: for instructions about how to install Python on your host machine please see the section on <a href="LSDTT_visualisation.html#_installing_the_lsdtopotools_python_toolchain">the LSDTopoTools python toolchain</a>.</p>
</div>
<div class="paragraph">
<p>Open the file called <code>drainage_density_plot.py</code>.  We suggest doing this on your host machine rather than the virtual machine: for instructions about how to install Python on your host machine please see the section on <a href="LSDTT_visualisation.html#_installing_the_lsdtopotools_python_toolchain">the LSDTopoTools python toolchain</a>.</p>
</div>
<div class="paragraph">
<p>If you want to run the script on the example dataset you can just run it without changing anything. The script will create the file <code>Guadalupe_DEM_drainage_density_all_basins.png</code> in the same folder as your DEM is stored in.  If you want to run it on your own data, simply open the Python script in your favourite text editor.  At the bottom of the file you need to change the DataDirectory (Line 165) and the DEM identifier (Line 167) to reflect your data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Set the data directory here - this should point to the folder with your DEM
DataDirectory = 'C:\\vagrantboxes\\LSDTopoTools\\Topographic_projects\\Guadalupe_NM\\'
# Name of the DEM WITHOUT FILE EXTENSION
DEM_name = 'Guadalupe_DEM'
make_plots(DataDirectory, DEM_name)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should end up with a plot like the one below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Guadalupe_DEM_drainage_density_all_basins.png" alt="Plot of drainage density against mean hilltop curvature" width="600" height="400">
</div>
<div class="title">Figure 8. Plot of drainage density against mean hilltop curvature for the Guadalupe Mountains example dataset</div>
</div>
</div>
<div class="sect3">
<h4 id="_summary">4.3.5. Summary</h4>
<div class="paragraph">
<p>You should now be able to extract the drainage density and mean hilltop curvature for all basins of a given order for your DEM, and use Python to plot the results.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_analysing_drainage_density_for_basins_with_crn_derived_erosion_rates">4.4. Analysing drainage density for basins with CRN-derived erosion rates</h3>
<div class="paragraph">
<p>This section provides instructions for how to extract the drainage density for basins upstream of a series of point locations, such as cosmogenic radionuclide (CRN)-derived erosion rate samples.  As an example, we will use the erosion rate data collected by Hurst et al. (2012) and Riebe et al. (2000) for the Feather River, Northern California.  The lidar data for this area is available from <a href="http://www.opentopography.org/">OpenTopography</a>. We haven&#8217;t included it in our example datasets as it is too large, but information on how to convert it into the right format can be found in our section on <a href="LSDTT_introduction_to_geospatial_data.html#_gdal">GDAL</a>.</p>
</div>
<div class="sect3">
<h4 id="_formatting_your_erosion_rate_data">4.4.1. Formatting your erosion rate data</h4>
<div class="paragraph">
<p>The program needs to read in a text file with the erosion rate data.  This file needs to be called <code>DEM_name_cosmo.txt</code> where <code>DEM_name</code> is the name of the DEM <strong>without extension</strong>.  The file should have a row for each sample, with 4 columns, each separated by a space:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>X coordinate - same as DEM coordinate system</p>
</li>
<li>
<p>Y coordinate - same as DEM coordinate system</p>
</li>
<li>
<p>Erosion rate of the sample</p>
</li>
<li>
<p>Error of the sample</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An example of the file for the Feather River is shown below (UTM Zone 10N):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">640504.269	4391321.669	125.9	23.2
647490.779	4388656.033	253.8	66.6
648350.747	4388752.059	133.3	31.9
643053.985	4388961.321	25.2	2.7
643117.485	4389018.471	18.5	2
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This file has to be stored <strong>in the same folder as your DEM</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_the_paramter_file_2">4.4.2. Creating the paramter file</h4>
<div class="paragraph">
<p>Along with the text file with the erosion rate data, you must also create a parameter file to run the code with.  This should have the same format as the parameter file for running the analysis on all the basins, minus the last two lines. The format is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-paramfile" data-lang="paramfile">Name of the DEM without extension
Name of the channel heads file - will vary depending on your channel extraction method
Minimum slope for filling the DEM</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should also be stored in the same folder as your DEM.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_1_run_the_code">4.4.3. Step 1: Run the code</h4>
<div class="paragraph">
<p>Before the code can be run, you must compile it using the makefile in the folder <code>LSDTopoTools_DrainageDensity/driver_functions_DrainageDensity</code>.  Navigate to the folder using the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ cd driver_functions_DrainageDensity/</code></pre>
</div>
</div>
<div class="paragraph">
<p>and compile the code with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ make -f get_drainage_density_cosmo.make</code></pre>
</div>
</div>
<div class="paragraph">
<p>This may come up with some warnings, but should create the file <code>get_drainage_density_cosmo.out</code>. You can then run the program with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ ./get_drainage_density_cosmo.out /path/to/DEM/location/ name_of_parameter_file.driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>/path/to/DEM/location</code> is the path to your DEM, and <code>name_of_parameter_file.driver</code> is the name of the parameter file you created.</p>
</div>
<div class="paragraph">
<p>The program will create a text file called <code>DEM_name_drainage_density_cosmo.txt</code> which can be ingested by our Python script to plot up the data.  This file has 9 rows with the following data:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Drainage density of the basin</p>
</li>
<li>
<p>Mean basin slope</p>
</li>
<li>
<p>Standard deviation of slope</p>
</li>
<li>
<p>Standard error of slope</p>
</li>
<li>
<p>Basin erosion rate</p>
</li>
<li>
<p>Error of the basin erosion rate</p>
</li>
<li>
<p>Basin drainage area</p>
</li>
<li>
<p>Mean hilltop curvature of the basin</p>
</li>
<li>
<p>Standard error of hilltop curavture</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It will also create some new rasters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DEM_name_slope: slope of the DEM</p>
</li>
<li>
<p>DEM_name_curv: curvature of the DEM</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_plot_the_data">4.4.4. Step 2: Plot the data</h4>
<div class="paragraph">
<p>Navigate to the folder <code>Python_scripts</code> within the <code>LSDTopoTools_DrainageDensity</code> repository.  You should find the following files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">vagrant@vagrant-ubuntu-precise-32:/LSDTopoTools/Git_projects/LSDTopoTools_DrainageDensity/Python_scripts$ ls
drainage_density_plot.py	drainage_density_plot_cosmo.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open the file called <code>drainage_density_plot_cosmo.py</code>.  We suggest doing this on your host machine rather than the virtual machine: for instructions about how to install Python on your host machine please see the section on <a href="#Getting python running">[Getting python running]</a>.</p>
</div>
<div class="paragraph">
<p>Open the Python script in your favourite text editor.  At the bottom of the file you need to change the DataDirectory (Line 131) and the DEM identifier (Line 133) to reflect your data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># change this to the path to your DEM
DataDirectory = 'C:\\vagrantboxes\\LSDTopoTools\\Topographic_projects\\Feather_River\\'
# Name of the DEM WITHOUT FILE EXTENSION
DEM_name = 'fr1m_nogaps'
make_plots(DataDirectory, DEM_name)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should end up with a plot like the one below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/fr1m_nogaps_drainage_density_cosmo.png" alt="Plot of drainage density against erosion rate" width="600" height="400">
</div>
<div class="title">Figure 9. Plot of drainage density against erosion rate for basins with CRN samples for Feather River, California</div>
</div>
</div>
<div class="sect3">
<h4 id="_summary_2">4.4.5. Summary</h4>
<div class="paragraph">
<p>You should now be able to extract the drainage density for a series of different basins across the landscape.  These can either be all basins of a specific order (Step 1), or basins defined by point coordinates (e.g. for catchment-averaged erosion rates from CRN samples in Step 2).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_channel_extraction_parameter_file_options">Appendix A: Channel extraction parameter file options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are the options for the <code>lsdtt-channel-extraction</code> program, which you can modify in the parameter file.</p>
</div>
<div class="paragraph">
<p>Parameter files are simpletext files that can be modified with a text editor.</p>
</div>
<div class="sect2">
<h3 id="_channel_extraction_options">A.1. Channel extraction options</h3>
<div class="paragraph">
<p>The parameter file has keywords followed by a value. The format of this file is similar to the files used in our <strong>LSDTT_BasicMetrics</strong> program, which you can read about in the our section introducing LSDTopoTools: <a href="LSDTT_basic_usage.html">Basic usage of <strong>LSDTopoTools</strong></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The parameter file has a specific format, but the filename can be anything you want. We tend to use the extensions <code>.param</code> and <code>.driver</code> for these files, but you could use the extension <code>.MyDogSpot</code> if that tickled your fancy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter file has keywords followed by the <code>:</code> character. After that there is a space and the value.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Channel extraction parameter file format</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Lines beginning with <code>#</code> are comments.</p>
</li>
<li>
<p>Keywords or phrases are followed by a colon (<code>:</code>).</p>
</li>
<li>
<p>The order of the keywords do not matter.</p>
</li>
<li>
<p>Keywords are not sensitive, but must match expected keywords.</p>
</li>
<li>
<p>If a keyword is not found, a default value is assigned.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Below are options for the parameter files. Note that all DEMs must be in ENVI <code>bil</code> format (<strong>DO NOT</strong> use ArcMap&#8217;s bil format: these are two different things. See the <a href="LSDTT_introduction_to_geospatial_data.html#_data_sources">documentation on data sources</a> if you want more details).
The reason we use <code>bil</code> format is because it retains georeferencing which is essential to our file output since many of the files output to <code>csv</code> format with latitude and longitude as coordinates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. File input and output options. <strong>These do not have defaults and MUST be declared</strong>.</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to which data is written. <strong>The code will NOT create a path: you need to make the write path before you start running the program.</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path from which data is read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write fname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The prefix of rasters to be written <strong>without extension</strong>.
For example if this is <code>Test</code> and you have selected <code>bil</code> format then a fill operation will result in a file called <code>Test_Fill.bil</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read fname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The filename of the raster to be read without extension. For example if the raster is <code>MyRaster.bil</code>, read fname will be <code>MyRaster</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">channel heads fname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The filename of a channel heads file. You can import channel heads. If this is set to <code>NULL</code> then the channels will be calculated using a pixel threshold. The channel head file format is a csv with a channel head coordinates on each row, in easting and northing. The first line is a header line. There can be multiple different columns but there must be and easting and northing column. The easting and northing need to be in the cooridinate system of the DEM.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Raster preprocessing</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum_elevation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you have the <code>remove_seas</code> keyword set to true, the program will change any elevation node below this value to NoData.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximum_elevation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you have the <code>remove_seas</code> keyword set to true, the program will change any elevation node above this value to NoData.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remove_seas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, this changes extreme value in the elevation to NoData.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">raster_is_filled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the code assumes the raster is already filled and doesn&#8217;t perform the filling routine. This should save some time in computation, but make sure the raster really is filled or else you will get segmentation faults!</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Options for what analysis to do.</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 50.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_area_threshold_channels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate channels based on an area threshold.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_dreich_channels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate channels based on the dreich algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_pelletier_channels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate channels based on the pelletier algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_wiener_channels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calculate channels based on our wiener algorithm.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Options for what files to output</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 50.0002%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_stream_order_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints a raster with channels indicated by their strahler order and nodata elsewhere. File includes "_SO" in the filename.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_channels_to_csv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints a csv file with the channels, their channel pixel locations indicated with latitude and longitude in WGS84.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_sources_to_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints a raster with source pixels indicated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_sources_to_csv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints a csv file with the sources, their locations indicated with latitude and longitude in WGS84.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_fill_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the fill raster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">write hillshade</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the hillshade raster to file (with "_hs" in the filename).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_wiener_filtered_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the raster after being filter5ed by the wiener filter to file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_curvature_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints two rasters of tangential curvature. One is short and one long wave (has "_LW" in name) curvature.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Parameters for extracting the channel network</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">min_slope_for_fill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum slope between pixels used by the filling algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">surface_fitting_radius</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Radius of the polyfit window over which to calculate slope and curvature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">curvature_threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Threshold curvature for channel extraction. Used by Pelletier (2013) algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum_drainage_area</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by Pelletier (2013) algorithm as the minimum drainage area to define a channel. In m<sup>2</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pruning_drainage_area</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the wiener and driech methods to prune the drainage network. In m<sup>2</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">threshold_contributing_pixels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to establish an initial test network, and also used to create final network by the area threshold method.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connected_components_threshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum number of connected pixels to create a channel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A_0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>A<sub>0</sub></strong> parameter (which nondimensionalises area) for chi analysis. This is in m<sup>2</sup>. Used by Dreich.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m_over_n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>m/n</strong> paramater (sometimes known as the concavity index) for calculating chi. Used only by Dreich.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number_of_junctions_dreich</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of tributary junctions downstream of valley head on which to run DrEICH algorithm.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. These are options for drainage area extraction.</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Input type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">surface_fitting_radius</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The radius of the polynomial window over which the surface is fitted. If you have lidar data, we have found that a radius of 5-8 metres works best.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_dinf_drainage_area_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, prints drainage area calculated using the d-infinity algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_d8_drainage_area_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, prints drainage area calculated using the d8 algorithm. This is simply the steepest of the 8 nearest neighbours.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_QuinnMD_drainage_area_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, prints drainage area calculated using the Quinn algorithm. This is a multiple flow direction algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_FreemanMD_drainage_area_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, prints drainage area calculated using the Freeman algorithm. This is a multiple flow direction algorithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print_MD_drainage_area_raster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, prints drainage area calculated using the multidirectional algorithm. This is a multiple flow direction algorithm. Unlike the Quinn and Freeman algorithms it makes no attempt whatsoever to control dispersion.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_channel_extraction_file_formats">5. Channel extraction file formats</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The different channel extraction methods insert different characters into the filenames.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Characters in filenames denoting the extraction method</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">String</th>
<th class="tableblock halign-left valign-top">Extraction method</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">area threshold</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">area threshold</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">area threshold</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">area threshold</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, there are characters at the end of filenames that deonte particular file types</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Characters in filenames denoting the extraction method</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Extension</th>
<th class="tableblock halign-left valign-top">file type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HS.bil</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A hillshade raster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sources.csv</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A sources file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CN.csv</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A channel network file</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_channel_sources_files">5.1. Channel sources files</h3>
<div class="paragraph">
<p>This file has five colums:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csv" data-lang="csv">node,x,y,latitude,longitude</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>node</code> is the node index, specific to that particular DEM. It cannot be transferred between two different DEMs</p>
</li>
<li>
<p><code>x</code> and <code>y</code> are the x and y locations in the DEM&#8217;s coordinante system. It can be transferred between DEMs with the same coordinate system.</p>
</li>
<li>
<p><code>latitude</code> and <code>longitude</code> are the latitude and longitude in WGS84. The conversion tools in <strong>LSDTopoTools</strong> means that these can be transferred between any raster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For historic reasons, we use the <code>x</code> and <code>y</code> coordinate to read in channel head locations, but this will change (hopefully soon) to read latitude and longitide.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-08-27 11:06:09 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>