<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Boris Gailleton, School of Geosciences, University of Edinburgh (b.gailleton@sms.ed.ac.uk)">
<title>Python bindings for LSDTopoTools: Users and dev guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Python bindings for LSDTopoTools: Users and dev guide</h1>
<div class="details">
<span id="author" class="author">Boris Gailleton, School of Geosciences, University of Edinburgh (b.gailleton@sms.ed.ac.uk)</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_forewords">1. Forewords</a></li>
<li><a href="#_introduction">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_what_is_lsdtopotools">2.1. What is LSDTopoTools</a></li>
<li><a href="#_why_a_python_version">2.2. Why a Python Version</a></li>
<li><a href="#_format">2.3. Format</a></li>
</ul>
</li>
<li><a href="#_before_installing">3. Before Installing</a>
<ul class="sectlevel2">
<li><a href="#_command_line_interface_what_and_why">3.1. Command-line interface: what and why?</a></li>
<li><a href="#_python_interpreter_vs_commands">3.2. Python interpreter vs commands</a></li>
<li><a href="#_computing_environment_or_the_answer_to_the_relentless_question_why_is_python_so_hard_to_install">3.3. Computing environment, or the answer to the relentless question "Why is python so hard to install?"</a></li>
</ul>
</li>
<li><a href="#_installation">4. Installation</a>
<ul class="sectlevel2">
<li><a href="#_a_python_environment">4.1. A python environment</a>
<ul class="sectlevel3">
<li><a href="#_what_is_a_python_environment_and_why">4.1.1. What is a python environment and why</a></li>
<li><a href="#_installing_anaminiconda">4.1.2. Installing ana/miniconda</a></li>
<li><a href="#_terminal_cmd_or_conda_prompt">4.1.3. Terminal, cmd or conda prompt</a></li>
</ul>
</li>
<li><a href="#_creating_environment">4.2. Creating environment</a>
<ul class="sectlevel3">
<li><a href="#_installing_the_packages_soon_to_be_automated">4.2.1. Installing the packages (Soon to be automated):</a></li>
<li><a href="#_troubleshoot">4.2.2. Troubleshoot</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_getting_started_with_lsdtopytools">5. Getting started with lsdtopytools</a>
<ul class="sectlevel2">
<li><a href="#_code_structure_and_philosophy">5.1. Code structure and philosophy</a>
<ul class="sectlevel3">
<li><a href="#_python">5.1.1. Python</a></li>
<li><a href="#_lsdtopytools_coding_style">5.1.2. lsdtopytools coding style</a></li>
</ul>
</li>
<li><a href="#_getting_started">5.2. Getting started</a>
<ul class="sectlevel3">
<li><a href="#_load_your_data_into_the_system">5.2.1. Load your data into the system</a></li>
<li><a href="#_running_a_routine_general_case">5.2.2. Running a routine: general case</a></li>
<li><a href="#_save_and_load">5.2.3. Save and load</a></li>
</ul>
</li>
<li><a href="#_raster_preprocessing">5.3. Raster preprocessing</a>
<ul class="sectlevel3">
<li><a href="#_principle">5.3.1. Principle</a></li>
<li><a href="#_use_in_lsdtopytools">5.3.2. Use in lsdtopytools</a></li>
<li><a href="#_plotting_and_preprocessing_caveats">5.3.3. Plotting and preprocessing caveats</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_basic_manipulations">6. Basic Manipulations</a>
<ul class="sectlevel2">
<li><a href="#_common_flow_routines">6.1. Common Flow Routines</a></li>
<li><a href="#_channel_network_extraction">6.2. Channel Network Extraction</a></li>
<li><a href="#_watershed_labeling">6.3. Watershed labeling</a></li>
<li><a href="#_visualisation">6.4. Visualisation</a>
<ul class="sectlevel3">
<li><a href="#_base_map_plotting">6.4.1. Base map plotting:</a></li>
<li><a href="#_getting_and_saving_data">6.4.2. Getting and Saving Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_forewords">1. Forewords</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide aims to explain our <code>Python</code> bindings for <code>LSDTopoTools</code> algorithms (as many as possible). In this guide, we will go through:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The reasons of developping such a tool</p>
</li>
<li>
<p>How to quickly install and use it on <code>Windows</code>, <code>linux</code> (and probably <code>iOSs</code>)</p>
</li>
<li>
<p>(Ongoing work) How the code works and how to run the different routines</p>
</li>
<li>
<p>(TO DO) Our set of automated plotting routines and how to build yours</p>
</li>
<li>
<p>(TO DO) And finally a development guide for the lower-level interfaces and contributing to the software.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
These tools are still in early development: they might be quite unstable and will probably evolve rapidly.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_lsdtopotools">2.1. What is LSDTopoTools</h3>
<div class="paragraph">
<p>LSDTopoTools is an open-source research software proving a large set of algorithms to quantitatively describe landscapes. It covers a wide range of geomorphological applications with preprocessing routines (e.g., depression filling or carving, filtering), flow routines (Flow direction, accumulation, fastscape node ordering, &#8230;&#8203;), channel network extraction and advanced channel head location (e.g., Pelletier 2013, Clubb et al., 2014), Chi analysis and extraction of channel parameters (Mudd et al., 2014,2018, Gailleton et al., 2019) (TODO add an exhaustive list there). More generally it offers a high-performance framework to process topographic data.<br>
The core of he code is written in C&#43;&#43;, a fast and compiled low level language. Its main advantages is its speed, its flexibility (fine grained management of <code>memory</code> and <code>cpu</code>) and its wide community. Our algorithms are widely tested and developped in C&#43;&#43; and direct access is available through source code and docker containers (TODO:: ink to other doc pages).<br></p>
</div>
</div>
<div class="sect2">
<h3 id="_why_a_python_version">2.2. Why a Python Version</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is just about how and why we developped that version. If you just want to use it, you can skip that part.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>python</code> has many advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Free</strong> and <strong>open-source</strong>, making it a research-friendly language, as research should be accessible to anyone without the need of expensive proprietary software (not all universities, research institutes or individuals have access to MATLAB, ArcGIS or ERDAS for example).</p>
</li>
<li>
<p>Popular, it has a <strong>HUGE</strong> (I cannot make that bolder) community ready to help if you have a question (e.g., stackoverflow, <code>issue</code> system on github).</p>
</li>
<li>
<p><code>python</code> is easy-to-read and has several level of difficulties: it can be used as a simple scripting language (<em>i.e.</em> just telling few instruction to the computer, basically as easy as talking to a child) if needed but can be way further if needed.</p>
</li>
<li>
<p>Packaged-based: you can install bit of codes other people made really easily and use it. No need to reinvent the wheel if it is already fast enough.</p>
</li>
<li>
<p>Finally, it is simple to install and universal: you can use it on Windows, Linux, Mac, &#8230;&#8203;<br></p>
<div class="paragraph">
<p>Of course python also has some drawbacks. It simplicity comes with a cost of performances:</p>
</div>
</li>
<li>
<p>Large numerical operations in pure <code>python</code> can quickly become slow and you need to find the package that has been optimising the specific routine you want and has binded it to <code>python</code>. This is the case for most of the "common" routines (e.g., see <code>scipy</code> and <code>numpy</code> for an impressive collection of fast and fully coded numerical routines), but everything is not coded yet.</p>
</li>
<li>
<p><code>Python</code> can become a bit confusing as there are many different ways and packages to do a tasks.<br></p>
<div class="paragraph">
<p>These are the reasons we are still coding in C&#43;&#43; but providing access to these fast and optimised routines from <code>python</code>: It combines the simplicity, portability and software-catalog of <code>python</code> with the raw powerfullness of C&#43;&#43;. The only remaining drawback is that it requires some gymnastics behind the scene to transfer data between the two and to make easy installer, but you won&#8217;t care about that because we are doing it for you.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_format">2.3. Format</h3>
<div class="paragraph">
<p>Some wonderful tools have make this binding possible and deserve credits:
- <code>xtensors</code>, a C&#43;&#43; data structure with (<em>inter alia</em>) in-built linkage with the universally used <code>python numpy ndarrays</code>. This is developped by <a href="http://quantstack.net/">Quantstack</a>, I recommend having a look on the tools they develop for research, they are truly amazing</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pybind11</code>, a complete toolbox to bind C&#43;&#43; data structure to <code>python</code> objects. This low-level interface, <code>lsdtt_xtensor_python</code>, is the backbone of the bindings: it communicates directly with C&#43;&#43; and deal with internal memory ownership and this kind of questions.<br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using these tools, we provide two packages to use our code from <code>python</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>lsdtt_xtensor_python</code>, a low level interface. You may be interested by using directly this backend only if you want python access to the C&#43;&#43; code with minimum dependencies: if already built in <code>pip</code>, it only requires <code>pybinds</code> and <code>numpy</code> to run but requires minimum knowledge on <code>LSDTopoTools</code> code structure.</p>
</li>
<li>
<p><code>lsdtopytools</code>, built on the top of <code>lsdtt_xtensor_python</code>, it provides a user friendly interface to the code with straighforward functions and lot of automations. It also provides additional routine to loads most of the raster types (e.g., <code>tif</code>, <code>bil</code>, <code>ASCII grids</code>), easy I/O operations, visualisations, and can easily be linked with any other packages.</p>
</li>
<li>
<p>A command line interface (Undocumented so far): it allows you to quickly use lsdtt without writting code in a text file. For example creating a slope map, or extracting the sources, or creating automatic figures. Easier and quicker to use, they are however less customisable.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_installing">3. Before Installing</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section has been written as a clarification following many emails expressing confusion between the command prompt, python and python computing environments. These can be confusing for user not used to programming without graphic interaction (<em>ie</em> clicking on stuff) so here is a plain language explanation with potentially questionable analogies. If you already know basics about command prompts and <code>python</code>, jump to Installation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Programming involve using tools that are similar enough to be confusing, if one is not use to it. Therefore, before installing and using <code>lsdtopytools</code>, clarifications seem to be required about the differences between <code>python</code>, computing environment and command-line interfaces (terminal/prompt) and how it actually works. This explanation is in plain language and aim to gently introduce some concepts before actually learning the commands.</p>
</div>
<div class="sect2">
<h3 id="_command_line_interface_what_and_why">3.1. Command-line interface: what and why?</h3>
<div class="paragraph">
<p>The <em>every-day</em> way of using a computer is a graphical interface: you tell the computer to run a program by clicking on it. For example if you want to open a specific image, you just navigate to its folder in the file explorer by clicking on the different folder names and then on the image to open it. The computer knows how to open the image file thanks to its extension. If you want to modify it, you right click on it and use "open with" and select paint, gimp or whatever program you want.</p>
</div>
<div class="paragraph">
<p>Command-line interfaces (or console, terminal, prompt) are simply another way to tell the computer the same procedure (and actually the original way). Let&#8217;s stick to the aforementioned image analogy. Rather than clicking on folders to navigate to the one containing the image, you just write your way through it with commands. For example moving inside a folder called "image" is "cd image" and is the direct equivalent of clicking on the folder. Then, you have to command the computer to open the image with the right program: <code>preview name_of_image.png</code> (equivalent of double-clicking on it to visualise it with the default preview software) or "gimp name_of_image.png" (equivalent of right click and open with gimp).</p>
</div>
<div class="paragraph">
<p>Alright now why are we self-inflicting this "more complex" way. There are many reasons to that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Speed. Open ArcGIS and enjoy waiting the software to start, then load and display your rasters before even starting thinking about which analysis you&#8217;d like to run. Any graphic interface consumes significant resources from your computer and therefore time, whether you need to visualise it or not before running the analysis.</p>
</li>
<li>
<p>Reproducibility. You can make ArcGIS (or QGIS) reproducible but it is not straightforward: you&#8217;d have to detail any click you have made and write any parameter you gave to any toolbox you used. Then the user has to reproduce each steps exactly by entering itself the parameters, increasing the risk of typos and errors. With command line, everything is written and multiple commands can be re-executed if written in a text file (ie script). You want to re-run EXACTLY the same analysis on a different raster? Just change the name of the raster in the text file and that&#8217;s it.</p>
</li>
<li>
<p>Flexibility. This one concerns any person that want to automate or develop their own routines and new tools with our framework. Developing graphical interface takes a loooooooooooooot of time, constrain the program and kill any automation possibility: you can write multiple commands in a text file to be automated, you cannot click in advance, this is as simple.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are the reasons we are using the command line to help installing, using and developing our framework.</p>
</div>
</div>
<div class="sect2">
<h3 id="_python_interpreter_vs_commands">3.2. Python interpreter vs commands</h3>
<div class="paragraph">
<p>You will quickly realise (and send us email to ask why) writing <code>python</code> code in the command prompt won&#8217;t work and writing command lines in the python scripts will trigger error messages. These two are different things that can be easily confusing. <code>python</code> is a software (exactly like ArcGIS or MATLAB). It&#8217;s aim is to interpret the <code>python</code> language into machine language to run numerical operations. It is therefore made to understand <code>python</code> codes, usually written in scripts (ie text files containing text following a <code>python</code> syntax). Command prompt does not understand syntax written for <code>python</code>, <code>python</code> does. <code>python</code> does not understand if you talk to it like a computer, the command prompt does.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>We use the command prompt to run our python scripts by writing <code>python name_of_script.py</code> which means "computer, please use <code>python</code> to understand the text I have written in the file <code>name_of_script.py`". We have written a `python</code> version of our tools, therefore your text (code) detailing which way you need to use <code>lsdtopytools</code> will go in that script.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>We also have written some programs that directly run from the command prompt if you need out of the box and without the need of writing <code>python</code> syntax. These will be installed with the tools but have different names, for example the following command <code>lsdtt-basic-tools file=mydem.tif slope</code> means "computer, please use the program called <code>lsdtt-basic-tools</code> on the file <code>mydem.tif</code> (hopefully you name your file better than I do) with the analysis <code>slope</code>.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>The <code>python</code> syntax allows you to customise your set of routines and even combine it with others written in <code>python</code> whereas our command line tools are prewritten, less customisable,  easier routines to use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_computing_environment_or_the_answer_to_the_relentless_question_why_is_python_so_hard_to_install">3.3. Computing environment, or the answer to the relentless question "Why is python so hard to install?"</h3>
<div class="paragraph">
<p>Alright, if you open a command prompt now and write <code>lsdtt-basic-tools</code> or <code>python name_of_script.py</code>, your computer will tell you something like "I don&#8217;t recognise what your command" or "python did not manage to import lsdtopytools" which basically just means that you haven&#8217;t install the tools yet: the computer cannot guess what you want to run and we do not have a contract with computer manufacturer to pre-install our tools on all the computers in the world (yet). Although <code>python</code> might be recognised (as it is extremely common software), it is just an interpreter (e.g., read the codes it has and does what it can with it), it still requires our tools to be included in it.</p>
</div>
<div class="paragraph">
<p>Actually, <code>python</code> works the following way: it creates a computing environment (a virtual box inside the computer) and stores a bunch of packages that contains other codes. It calls these different codes together for you so you do not have to recode all the algorithm of the world. It also simplify a lot of programming aspects if you do not wish to use it (data type, memory management, etc.). <code>python</code> therefore is just a "glue" that gather multiple codes together inside taht box. Long strory short, you just have to add our bunch of code (<code>lsdtopytools</code>) to your computing environment and then you can use <code>python</code> syntax to call it. <code>python</code> in our case acts as a glue between pieces of other codes that read geolocalised rasters, pieces of our codes that run the analysis, pieces of codes that plot it, etc. .</p>
</div>
<div class="paragraph">
<p>Most of the difficulty in using <code>python</code> lies in the complex connectivity between the bunch of codes you need: some glues are incompatible with others and building that box can be tidious. <code>python</code> is open-source and free so anyone can write code for it making it impressively suitable for science but also increases the risk of having buggy packages and incompatible glues. Which is the reason why we use an environment manager called <code>conda</code> (detailed later). It allows us to tell the computer "Alright, I know you sometimes struggle gluing complex python packages together, so here is a tool that will store separate boxes that only contain compatible glues. I will just create a <code>lsdtopytools</code> box, putting all my compatible DEM analysis glues in that box and let you know when I want to use <code>python</code> inside that box OK?" (the computer won&#8217;t actually answer you). This guide will just show you how to create and use that box and avoid the "I tried python once and did not manage to install it so I gave up.".</p>
</div>
<div class="paragraph">
<p>+
Another well-known analogy is MATLAB. MATLAB is a proprietary software that provides one of these box ready-to-use. The difference is that it provides a closed unaccessible black box that comes already built with a specific set of their own software for anyone that pays (a <strong>LOT</strong>) for each separate extension. Our tools are written in <code>c++</code>, and we use <code>python</code> glue to make it easier to use and install (<code>python</code> backbone is written in <code>c</code> so we can easily link the two) thanks to <code>python</code> open-source nature. <a href="https://www.mathworks.com/pricing-licensing.html">Here</a> is the price to use MATLAB (not every institution, company or university have access to it) and here is the price of using <code>python</code>: 30 minutes of your time to learn how to download, install and manage these boxes. If you wish to use MATLAB for topographic analysis, the excellent <a href="https://topotoolbox.wordpress.com/">TopoToolBox</a> is a tool that has been developed within MATLAB framework and provides a different framework to tackle topographic related problems.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">4. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Soon, a <code>conda</code> receipe will be available, making the installation extremely straightforward. But before that, it still requires few simple manipulations as I am still working on the best way to do it.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">If you know how python works</div>
<div class="paragraph">
<p>Quick instruction if you are used to python environments:<br>
<strong>lsdtt_xtensor_python (required for any use)</strong><br>
So far there are two cases: either we have already built binaries for your OS/cpu:<br>
<code>pip install lsdtt_xtensor</code> will be extremely fast and easy, we have wheels for windows for sure at the moment (linux is somehow tricky, and I don&#8217;t have a mac).<br>
Otherwise you have to build it on your own machine (soon to be sorted with the conda reicepe):<br>
<code>conda install -c conda-forge pybind11 xtensor xtensor_python numpy</code><br>
Then you need a <code>cpp14</code> ready default compiler (again, this is temporary). If you reach this stage, you are probably on linux so install a gcc&gt;=5 and you shall be alright. <code>pip install lsdtt_xtensor</code> will now take a while but will work (it is directly compiling the code on your machine).<br>
<strong>lsdtopytools and command-line (for the simple interface)</strong><br>
Relatively easy: Install the dependencies and then the package.<br>
<code>conda install -c conda-forge numpy scipy pandas numba matplotlib gdal rasterio h5py</code><br>
<code>pip install lsdtopytools</code></p>
</div>
</div>
</div>
<div class="paragraph">
<p>The following guide gives you a step-by-step installation guide. It assumes no particular knowledge in computers/coding and will point to external tutorials when potentially needed. It will also explain the different steps, you don&#8217;t have to read it if you are in a hurry, but te more you understand what is happenning in the computer, the easier it is to debug it (and indirectly, less complaining emails for us as well).</p>
</div>
<div class="sect2">
<h3 id="_a_python_environment">4.1. A python environment</h3>
<div class="paragraph">
<p>If you already are comfortable with <code>python</code> and already have your own conda environment, you can skip that part.</p>
</div>
<div class="sect3">
<h4 id="_what_is_a_python_environment_and_why">4.1.1. What is a python environment and why</h4>
<div class="paragraph">
<p>The first step is to create a python environment. As stated before, <code>python</code> is a "<em>packaged</em>" language: all the code take advantage of other bit of codes made by the community called packages. The (really) good thing with it is that a lot of algorithms are already coded and you can integrate it in your <code>python</code> environment easily.<br>
The backside is that many packages relies on specific version of other packages and there can be some conflict when the environment becomes massif, the same way ArcGIS extentions are only compatible with some versions of the main software, or MATLAB scripts that absolutely require the specific version <code>2015rc4267-21f-march2016v2.5</code> to run.<br>
On the bright side, <code>python</code> is free and open-source, you can therefore install as many versions of python and its packges as you want. We strongly advice to use <code>miniconda</code> (or <code>anaconda</code>) as environment manager: you can create and activate different environments with their own packages. Even better, we can provide templates of environments to make it easy-to-install.<br>
A practical example: you can have one environment with <code>lsdtopytools</code> installed to run topographic analysis, a separate one with <code>landlab</code> to deals with modelling or even play with the packages to mix both tools in the same environment and run it together.</p>
</div>
</div>
<div class="sect3">
<h4 id="_installing_anaminiconda">4.1.2. Installing ana/miniconda</h4>
<div class="paragraph">
<p>You can download <code>miniconda</code> from <a href="https://conda.io/miniconda.html">this website</a>, and install it. It does not matter whether you have <code>miniconda</code> or <code>anaconda</code>: these are just <em>light</em> and <strong>full</strong> versions of the same tool. We advice <code>miniconda</code> to only install what you need and we advice <code>python 3.6</code> or <code>3.7</code>: we only tested our code on these versions. The code is theoretically compatible with <code>3.5</code>, <code>3.4</code> and <code>2.7</code> but I would imagine that if you need such a specific version of <code>python</code>, you&#8217;ll know how to deal with custum installation. Also, you need to know if your computer is 32 (if old) or 64 bits (most of post 2010 computer).<br>
You do not need admin right to install <code>conda</code> on your machine in case you are using institutions servers or computers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_terminal_cmd_or_conda_prompt">4.1.3. Terminal, cmd or conda prompt</h4>
<div class="paragraph">
<p>As many (scientific) tools, the scripts need to be ran in a console/terminal/command prompt/whichever name you want. Many reasons for that: easier to manage, control and automate; quicker; actually easy to use. The only bad side is that it looks less attractive than a nice graphic interface. Basically, rather than double clic on a folder, you need to write <code>cd name_of_the_folder</code> to chagne the current directory for instance.</p>
</div>
<div class="sect4">
<h5 id="_on_windows">On Windows</h5>
<div class="paragraph">
<p>After installing conda on <code>windows</code>, you can open a <code>conda prompt</code> from your start menu. Then you will be sure to be inside your <code>conda</code> environment and ready to navigate through your file tree to run programs. Here is a <a href="https://www.youtube.com/watch?v=MNwErTxfkUA">random tutorial</a> found online to learn to basics. There are many, you don&#8217;t need advanced knowledge, basically jsut how to navigate through folders, list the files in the folder and stuff like that.</p>
</div>
</div>
<div class="sect4">
<h5 id="_on_linux">On linux</h5>
<div class="paragraph">
<p>Depending on your <code>python</code> uses, you can either (i) add it to your <code>PATH</code> and make it your default <code>python</code> environment (it can make other program using default python unhappy, it is rare but it can happen); (ii) Follow <a href="https://conda.io/docs/user-guide/install/index.html#installing-conda-on-a-system-that-has-other-python-installations-or-packages">these instructions</a>. I assume you know how to deal with a terminal if you are using linux.</p>
</div>
</div>
<div class="sect4">
<h5 id="_on_mac">On Mac</h5>
<div class="paragraph">
<p>Who knows, it should be similar to <code>linux</code> anyway.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_environment">4.2. Creating environment</h3>
<div class="paragraph">
<p>You are now within a <code>conda</code> environment that includes <code>python</code>. Let&#8217;s have a clean install, cleaner computing is easier to debug. The following command creates a ("sub")environment in you conda installation, where we will install the packages we need. To run the command, just copy-paste it in the terminal and hit <code>enter</code>.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">conda create -n lsdtopytools</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once created, the environment just need to be activate each time a new terminal is opened! You just have to run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">conda activate lsdtopytools</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll know it is activated if <code>(lsdtopytools)</code> is displayed in your terminal. If you have an older version of conda, you may face a message error. You just have to use this command instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">source activate lsdtopytools</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;re basically done with environment stuff. You can create as many (or as few) environments as you need for your different programs (<em>e.g., landlab, opencv</em>).</p>
</div>
<div class="sect3">
<h4 id="_installing_the_packages_soon_to_be_automated">4.2.1. Installing the packages (Soon to be automated):</h4>
<div class="paragraph">
<p>let&#8217;s now install the required tools to run <code>lsdtt_xtensor_python</code> (the <code>cpp-python</code> mediator): we take advantage of carefully selected bits of other codes to help us.<br>
The following command installs package. <code>install</code> means (surprise) install, and <code>-c conda-forge</code> means from the channel (= repository) "conda-forge" which is in plain language a big pile of easy-to-install python packages. + The following keywords are the name of the packages: (i) <code>pip</code>, it makes easier <code>python</code> packages installation, (ii) <code>numpy</code>, an <strong>EXTREMELY</strong> used and powerful tools for arrays and matrix calculations. It is written in <code>fortran</code> and <code>c</code>, therefore its built-in functions (e.g., sum, median, reordering, and millions of common tools) are fast. (iii) <code>pybinds</code>, requires to link C&#43;&#43; to <code>python</code>.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">conda install -c conda-forge pip numpy pybind11 xtensor xtensor-python</code></pre>
</div>
</div>
<div class="paragraph">
<p>You environment is ready for <code>lsdtt_xtensor_python</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">pip install lsdtt_xtensor_python</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This was the trickest part, if the terminal throw a lot of error messages, it means that I did not manage yet to precompile the code for your platform. I am working on it but so far you need to build the package by yourself: it should be temporary. On linux: you need to install a recent compiler <code>gcc/gXX&gt;=5</code> or any recent <code>clang</code> and to make sure it is your default compiler. Then you jsut need to install two other dependencies: <code>conda install -c conda-forge xtensor xtensor-python</code> and if you rerun the above <code>pip</code> command it will run for approximatively 10 minutes and install the package. On Windows: compiling on windows is fxxxxxg pain, I fought long long (long) hours to generate a wheel (compiled python package) theoretically compatible with any 64bits windows to avoid this issue, contact me if my wheel failed for you. On Mac: see linux.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>lsdtt_xtensor_python</code> is required for any use of the python tools, but only provide minimal interface with the C&#43;&#43; code and require knowledge of its structure. You probably now need <code>lsdtopytools</code>, the full, user-friendly interface that also provide (will provide actually as it is work in progress) easy raster loading/saving, ergonomic data management and visualisation routines. This however requires a bunch of other packages to be install: the simplest a program is, the bigger the amount of code behind is.<br>
<code>lsdtopytools</code>, even if you won&#8217;t inteact with most of these, basically requires the following packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gdal</code>: a package, mostly in <code>C</code> that can deals with all the geodesy: projection, transformation, raster downsampling, WGS to UTM and billions of other tasks you don&#8217;t want to face manually. <a href="https://lsdtopotools.github.io/LSDTT_documentation/LSDTT_introduction_to_geospatial_data.html#_gdal">More Information</a>.</p>
</li>
<li>
<p><code>rasterio</code>: provides a nice interface to <code>gdal</code>, because I also want to simplify my coding when possible. <a href="https://rasterio.readthedocs.io/en/latest/">More Information</a>.</p>
</li>
<li>
<p><code>scipy</code>: alongside with <code>numpy</code>, it provides quick and useful stats, filters, modelling, math, <em>etc</em> routines for pre/post-processing. <a href="https://www.scipy.org/">More Information</a>.</p>
</li>
<li>
<p><code>pandas</code>: provides table-like data analysis tools. Very useful to manage dataframes of thousands/millions of river points for examples. <a href="https://www.scipy.org/">More Information</a>.</p>
</li>
<li>
<p><code>matplotlib</code>: paper-quality plots, unbeatable in this domains even if a bit frustrating sometimes. <a href="https://matplotlib.org/gallery/index.html">More Information</a>.</p>
</li>
<li>
<p><code>numba</code>: I will get rid of that dependency at some point, it provides speed-up on some internal part of older code I used. Not really needed now I can send stuff to C&#43;&#43; directly with <code>numpy</code>, but I&#8217;ll need time to recode these few routines, sns. <a href="http://numba.pydata.org/">More information</a>.</p>
</li>
<li>
<p><code>h5py</code>: is (will be, may be, idk yet) used to save file to the disk: fast and well structured, it is theoretically a better alternative to <code>csv</code> files. Outputs with <code>csv</code> will still be available to link with Arc/QGIS if needed. <a href="https://www.h5py.org/">More Information</a>.</p>
<div class="paragraph">
<p>To install, simply run:</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">conda install -c conda-forge gdal=2.2 rasterio scipy pandas matplotlib numba h5py pytables numpy</code></pre>
</div>
</div>
<div class="paragraph">
<p>It shall run for few minuts to install these dependencies, and finally you are ready for the last bit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terminal" data-lang="terminal">pip install lsdtopytools</code></pre>
</div>
</div>
<div class="paragraph">
<p>This one should be universal (<em>i.e.,</em> Compatible with with any OS as pure python stuffs).</p>
</div>
<div class="paragraph">
<p>And we are done with the installation!</p>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshoot">4.2.2. Troubleshoot</h4>
<div class="paragraph">
<p>There will be some, no worries.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started_with_lsdtopytools">5. Getting started with lsdtopytools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will explain the basics and general uses of <code>lsdtopytools</code>. The best way to learn is to practice: we therefore provide this code documentation for the details about each routines, but also an (hopefully at some point) <code>example</code> folder on the github page with practical cases you can just copy and adapt to your needs.</p>
</div>
<div class="sect2">
<h3 id="_code_structure_and_philosophy">5.1. Code structure and philosophy</h3>
<div class="sect3">
<h4 id="_python">5.1.1. Python</h4>
<div class="paragraph">
<p><code>python</code> is a nice high-level programming language. It is part of the <em>interpreted</em> languages, meaning that each line of code is interpreted one by one by a software (here python), other well-know free examples are <code>perl</code>, <code>R</code>, <code>Julia</code> or the somehow popular not free and not open source <code>MATLAB</code>. These languages are useful to take abstraction of complex machine interaction such as memory management and control other more complex underlying code. There is no need to have advanced <code>python</code> or coding knowledge to use our tools, <code>python</code> is easy to write and read. <a href="https://www.codecademy.com/learn/learn-python">Code academy</a> offers a nice tutorial to get the basis (not mandatory but can be useful).<br>
To run a custom <code>python</code> script: simply navigate to the right directory within your <code>conda</code> terminal (see installation instructions) and run <code>python name_of_my_script.py</code>.<br>
If you don&#8217;t want to learn this useful tool, use the command-line interface.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lsdtopytools_coding_style">5.1.2. lsdtopytools coding style</h4>
<div class="paragraph">
<p><code>lsdtopytools</code> is coded in an <em>object oriented</em> logic: we have some precoded routines absed on a common template that you just need to construct with your custom parameters. Basically all our routines are based on an original DEM that you load first. Then each routines depends on others and the code deals internally on how to call these interaction. This sound probably fuzzy so let&#8217;s illustrate with an example:<br>
Let&#8217;s imagine you have a <code>geotif</code> DEM of your area and you want to extract channel steepness. You need many information to do so: the code needs to know the flow direction of your DEM cells, it needs to know the drainage area, which pixels is a river and many different bits of data you probably don&#8217;t have yet. Thanks to the <em>object orientation</em> you just have to call the <code>ksn</code> extraction routine and the code will know what it needs to calculate beforehand, tells you what it is defaulting and what you could add to cusomise each steps and finally run the wanted routine.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_started">5.2. Getting started</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Your data needs to be in UTM projection to work correctly. Geographic system (e.g., WGS84) are not in metres, therefore the metrics are not straightforward to understand.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_load_your_data_into_the_system">5.2.1. Load your data into the system</h4>
<div class="paragraph">
<p>The first step of each routines is to load the base raster: your dem from which the metrics will be calculated. You simply need to import the code (as any <code>python</code> code) and load the dem as follow:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from lsdtopytools import LSDDEM # LSDEM is the object template abovementioned

my_dem = LSDDEM(file_name = "name+of_my_dem.tif")</code></pre>
</div>
</div>
<div class="paragraph">
<p>+
THis is the simplest way to load a dem. It however implies that your dem is in the same folder than your <code>python</code> script. You can load a de with the following options:<br></p>
</div>
<div class="paragraph">
<p>, path = "./", file_name = "test.tif", already_preprocessed = False, verbose = True)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>path</strong>: the path to your file. On windows it can be <code>"C:\Users\s1675537\Desktop\"</code>, on linux <code>"/home/s1675537/Data/"</code>. If you don&#8217;t give this option, the default value is <code>"./"</code>: it means current folder.</p>
</li>
<li>
<p><strong>file_name</strong>: the file name with the extension. <code>lsdtopytools</code> relies on <code>rasterio</code> and <code>gdal</code> to load raster. It can (theoretically) understand <a href="https://www.gdal.org/formats_list.html">these</a> formats. The most common are working (<em>e.g.,</em> <code>.tif</code>, <code>.bil</code> or ASCII grids).</p>
</li>
<li>
<p><strong>already_preprocessed</strong> (boolean): <code>False</code> if your DEM needs preprocessing (see <a href="#_raster_preprocessing">Raster preprocessing</a>) and <code>True</code> if already preprocessed externally.</p>
</li>
<li>
<p><strong>verbose</strong> (boolean): The code can talk: it details what it is doing and tells you where there are some important warnings. Activated by default, you can turn it off with <code>verbose = False</code> if you want less outputs.</p>
<div class="paragraph">
<p>We are basically done with the initialisation, all the different metrics generated from DEM require this line of code at the beginning of a script. The next parts will describe the different routines.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_running_a_routine_general_case">5.2.2. Running a routine: general case</h4>
<div class="paragraph">
<p>Before explaining each routines, all of them are build following the same pattern around the <code>LSDDEM</code> object. You call the routine ON the object the following way:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...

my_dem.routine_name(routine_param1 = 54, routine_param2 = "auto")</code></pre>
</div>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>It either process and store internally new result, return a dataset to you or generate a figure depending on the routine called. In a single script, if a routine has already been ran, the results are usually stored internally.</p>
</div>
</div>
<div class="sect3">
<h4 id="_save_and_load">5.2.3. Save and load</h4>
<div class="paragraph">
<p>Not available yet. But some routines can take a certain amount of time to run (even in <code>c++</code>), I am therefore implementing a save-load system based on <code>h5py</code> package. The aim is to load and save only what you need behind the scene to save memory and processing time. It will take a wee time to do properly, please bear with me. An easy solution would be to use <code>pickle</code>, but by experience it crashes and uses a LOT of memory when dealing with large dataset (e.g, a raster).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_raster_preprocessing">5.3. Raster preprocessing</h3>
<div class="sect3">
<h4 id="_principle">5.3.1. Principle</h4>
<div class="paragraph">
<p>Most of the routines uses flow information to generates metrics, the most striking example being river extraction: the program obviously needs to know where the water will flow to calculate rivers. Preprocessing in our case means <em>making sure that all our cells are draining to another one or to an edge</em>. This is essential as DEM are inherantly noisy: this noise will produce artificial pits and depressions. Although minor in the digital topography, these will be fatal to a program as the program will end any flow into these pit therefore biasing drainage area, flow direction, basin outlet or many other routines.<br>
The solution is to <strong>carve</strong> (sometimes refered as breaching) or to fill these depressions. Respectively, it either "<em>dig</em>" a way out of the depression to the nearest outreach or fill the depression until water can (numerically, there no real water involved) drain to another cell. Carving usually modify less cells than filling but is more computationnaly expensive, and filling is usually required after carving to ensure minimum slope on flat surfaces.<br></p>
</div>
</div>
<div class="sect3">
<h4 id="_use_in_lsdtopytools">5.3.2. Use in lsdtopytools</h4>
<div class="paragraph">
<p>In the program, you can either feed the code with a dem externaly preprocessed, see <a href="#_load_your_data_into_the_system">Load your data into the system</a>, or use one of our filing and carving algorithm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...

my_dem.PreProcessing(filling = True, carving = True, minimum_slope_for_filling = 0.0001)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It preprocesses your base raster and save it into the associated <code>LSDDEM</code> object. The options are the following:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>carving (boolean): Enables the carving algorithm: Lindsay (2016), DOI: 10.1002/hyp.10648.</p>
</li>
<li>
<p>filling (boolean): Enables the filling algorithm: Wang and Liu (2006), DOI: <a href="https://doi.org/10.1080/13658810500433453" class="bare">https://doi.org/10.1080/13658810500433453</a>.</p>
</li>
<li>
<p>minimum_slope_for_filling: imposes a minimum slope while filling. Keep it low to avoid over filling flat areas.</p>
<div class="paragraph">
<p>After being preprocessed, the raster is ready to generate flow metrics.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_plotting_and_preprocessing_caveats">5.3.3. Plotting and preprocessing caveats</h4>
<div class="paragraph">
<p>This guide does not aim to discuss the filling and carving algorithm performances, relevant literature does that. So short story long, one might want to check the preprocessing result because (i) filling can generate "<em>overfilled</em>" areas, where for example a bridge or a dam creates an artificial obstacle; (ii) carving and filling alters the original data and therefore can generate unwanted artifact that one need to be aware to avoid misinterpretations.<br></p>
</div>
<div class="sect4">
<h5 id="_topographic_map">Topographic map</h5>
<div class="paragraph">
<p>We provide some plotting routines to plot the topography and preprocessing results. The first routine generates a nice, publication-ready topographic map. It calculates an hillshade of your topography (simulation of natural light to enhance relief) and drape it on a topographic map, any metrics you want to plot need to be calculated beforehand.<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Our plotting routines depend on other sub-modules that you need to import first: <code>from lsdtopytools import quickplot</code> will do the trick for this one.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...

from lsdtopytools import quickplot

quickplot.plot_nice_topography(my_dem, figure_width = 4, figure_width_units = "inches", cmap = "gist_earth", hillshade = True,  alpha_hillshade = 0.45, color_min = None, color_max = None, dpi = 300, output = "save", format_figure = "png")</code></pre>
</div>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p><code>quickplot.plot_nice_topography(my_dem)</code> would work with default parameters, but the following customisations are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>figure_width</code>: the real width of the final figure. A matplotlib figure contains the plot, its axis, labels, padding, etc.</p>
</li>
<li>
<p><code>figure_width_units</code>: Can be <code>inches</code>, which unfortunately is the default in matplotlib or "centimetre", a real unit.</p>
</li>
<li>
<p><code>cmap</code>: the name of the colormap to use. For example <code>"jet"</code> or our default <code>"gist_earth"</code>. Exhaustive list <a href="https://matplotlib.org/examples/color/colormaps_reference.html">on `matplotlib&#8217;s website</a>.</p>
</li>
<li>
<p><code>hillshade</code>: <code>True</code> by default, you can switch it to <code>False</code> to disable the transparent hillshade draped on top of the topography.</p>
</li>
<li>
<p><code>alpha_hillshade</code>: Transparency of the hillshade: 0 is fully transparent and 1 fully opaque (would hide the toography).</p>
</li>
<li>
<p><code>color_min</code>: minimum elevation that will correspond to the minimum color on the colormap. For example if my landscape ranges from 50 to 2000 and if I set this value to 500, all value between 50 and 500 will have the same color. If you don&#8217;t customise it, it will be the minimum value.</p>
</li>
<li>
<p><code>color_max</code>: same principle with the maximum color. If you don&#8217;t customise it, it will be the maximum value.</p>
</li>
<li>
<p><code>dpi</code>: quality of the bitmap if saved. <code>300</code> is an acceptable quality, <code>900</code> would be really fine, for a large poster for example. Increasing the dpi obviously increases the size of the file.</p>
</li>
<li>
<p><code>output</code>: Can be <code>"save"</code> to save a figure in the same folder than the raster you loaded; <code>"show"</code> triggers <code>plt.show()</code> and <code>"return"</code> which returns <code>fig,ax</code> if you need to customise your figure in <code>python</code> using <code>matplotlib</code>.</p>
</li>
<li>
<p><code>format_figure</code>: If <code>output</code> is <code>"save"</code>, you can use <code>"png"</code> (good quality, medium size), <code>"svg"</code> (vector image, can be edited with illustrator (Proprietary), coreldraw (proprietary) or inkscape (free and open-source)) or any other <code>maplotlib</code>-supported format (It can depend on extra dependencies, see <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.savefig.html">this help page from <code>matplotlib</code> documentation</a>).</p>
<div class="paragraph">
<p>It will produce the following result:<br></p>
</div>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/example_topo.png" alt="example topo" width="1000" height="600">
</div>
<div class="title">Figure 1. Example topographic plot. Script available in the example folder on the github repository (TODO: Add link to the public repo)</div>
</div>
</div>
<div class="sect4">
<h5 id="_preprocessing_check">Preprocessing check</h5>
<div class="paragraph">
<p>We also provide a quick plotting routine to check the preprocessing results and if any artifact has appeared. Use it as follow.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...
quickplot.plot_preprocessing_diff(my_dem)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following customisations are available:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>figure_width</code>: the real width of the final figure. A matplotlib figure contains the plot, its axis, labels, padding, etc.</p>
</li>
<li>
<p><code>figure_width_units</code>: Can be <code>inches</code>, which unfortunately is the default in matplotlib or "centimetre", a real unit.</p>
</li>
<li>
<p><code>cmap</code>: the name of the colormap to use. For example <code>"jet"</code> or our default <code>"gist_earth"</code>. Exhaustive list <a href="https://matplotlib.org/examples/color/colormaps_reference.html">on `matplotlib&#8217;s website</a>.</p>
</li>
<li>
<p><code>color_min</code>: minimum elevation that will correspond to the minimum color on the colormap. For example if my landscape ranges from 50 to 2000 and if I set this value to 500, all value between 50 and 500 will have the same color. If you don&#8217;t customise it, it will be the minimum value.</p>
</li>
<li>
<p><code>color_max</code>: same principle with the maximum color. If you don&#8217;t customise it, it will be the maximum value.</p>
</li>
<li>
<p><code>dpi</code>: quality of the bitmap if saved. <code>300</code> is an acceptable quality, <code>900</code> would be really fine, for a large poster for example. Increasing the dpi obviously increases the size of the file.</p>
</li>
<li>
<p><code>output</code>: Can be <code>"save"</code> to save a figure in the same folder than the raster you loaded; <code>"show"</code> triggers <code>plt.show()</code> and <code>"return"</code> which returns <code>fig,ax</code> if you need to customise your figure in <code>python</code> using <code>matplotlib</code>.</p>
</li>
<li>
<p><code>format_figure</code>: If <code>output</code> is <code>"save"</code>, you can use <code>"png"</code> (good quality, medium size), <code>"svg"</code> (vector image, can be edited with illustrator (Proprietary), coreldraw (proprietary) or inkscape (free and open-source)) or any other <code>maplotlib</code>-supported format (It can depend on extra dependencies, see <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.savefig.html">this help page from <code>matplotlib</code> documentation</a>).</p>
</li>
<li>
<p><code>n_dec_lab</code> (int): precision of the colorbar tick labels.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It will produce the following results: an example with only filling and another one with carving and filling. Note that filling affect the raw data a bit more. A lot of changes happen only on few pixels and are hard to distinct. The significantly filled area correspond to a dam.<br></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/example_PP_delta.png" alt="example PP delta" width="1000" height="600">
</div>
<div class="title">Figure 2. Result after filling.</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/example_PP_both.png" alt="example PP both" width="1000" height="600">
</div>
<div class="title">Figure 3. Result after carving and fillings.</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_manipulations">6. Basic Manipulations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to calculate common flow routines that are required for most of the analysis. All of the routines calculating flows or river-related metrics require the calculation of flow accumulation, direction, drainage area or the actual position of rivers.<br></p>
</div>
<div class="sect2">
<h3 id="_common_flow_routines">6.1. Common Flow Routines</h3>
<div class="paragraph">
<p>Before locating the actual channel, the software needs to know few information in order to organise the cells and their connections. This is very straightforward:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...
my_dem.CommonFlowRoutines()</code></pre>
</div>
</div>
<div class="paragraph">
<p>So far, this is it. It calculates behind the scene a number of node ordering, flow direction, flow accumulation, drainage area. Node ordering is similar to <a href="https://doi.org/10.1016/j.geomorph.2012.10.008">Braun and Willett, 2013 (fastscape)</a>. Drainage area is based on a <em>D8</em> method from <a href="https://doi.org/10.1016/S0734-189X(84)80011-0">O&#8217;Callaghan and Mark, 1988</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We are still building the <code>python</code> bindings, other methods will be implemented (<em>e.g.,</em> Dinf for drainage area calculations), let us know if you need it soon.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_channel_network_extraction">6.2. Channel Network Extraction</h3>
<div class="paragraph">
<p><code>LSDTopoTools</code> extracts rivers by detecting the channel head locations and then building the network following flow direction. Several algorithms are available depending on (i) how important sources location is each case; (ii) your dem resolution (<a href="https://doi.org/10.5194/esurf-4-627-2016">Grieve et al., 2016 for relevant discussion</a>); (iii) landscape characteristics. The generic python function is the following:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...
my_dem.ExtractRiverNetwork(method = "name of the method", corresponding_argument_1 = ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where each methods has several arguments to customise the extraction.<br></p>
</div>
<div class="paragraph">
<p><code>method = "area_threshold"</code> is the most basic one. It is suitable when your DEM resolution is coarser than about 10m (<em>e.g.,</em> SRTM or ASTER) or if source location is not important. Extremely straightforward and efficient, it initiates a channel when a certain number of other cells are draining into a single one. It only has one parameters:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>area_threshold_min: the number of cells required to initiate a channel.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
We are implementing the other methods now: DREICHT, Pelletier and a geometric method based on Weiner filtering.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_watershed_labeling">6.3. Watershed labeling</h3>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
We are still refining these methods. In few cases they can be buggy and requires to play a bit with the parameters to obtain wanted results.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some routines, for example river concavity analysis, knickpoint extraction or \(k_{sn}\) extraction requires watershed labelling to focus on certain drainage networks. It also ensures that the area you are studying is actually complete: you don&#8217;t want to extract \(\chi\) with biased drainage area for example. Watershed labelling in <code>LSDTopoTools</code> requires the river network to be extracted first.<br>
The following method run the watershed labeling, customisable with several methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">...
# add that line to previous code to define the catchments
my_dem.DefineCatchment(method="name_of_method", param_for_method = ...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available methods are the following:<br></p>
</div>
<div class="paragraph">
<p><code>"min_area_pixels"</code> extracts all catchments containing more than a certain amount of pixels. Basic but efficient. It can be customise with the following arguments:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>test_edges</code>: If True, will test if te basin is complete or draining into no data. It will also ignore your basin if there is internal no data.</p>
</li>
<li>
<p><code>min_area_pixels</code>: The number of pixel to select a watershed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>"from_XY"</code> extracts catchments by X-Y coordinates of the outlets. From far the most reliable method to get specific basin, but requires manual inputs. It takes the following arguments:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>X_coords</code>: a list of outlet X coordinates. For example <code>[450524,521002,522035]</code>. It needs to be (i) in the raster units (probably UTM) and (ii) the same length of the corresponding Y coordinates.</p>
</li>
<li>
<p><code>Y_coords</code>: a list of outlet Y coordinates. For example <code>[6226620,6275620,6226671]</code>. It needs to be (i) in the raster units (probably UTM) and (ii) the same length of the corresponding X coordinates.</p>
</li>
<li>
<p><code>coord_search_radius_nodes</code>: an integer defining the number of node to investigate around the input coordinates and find a river to snap to.</p>
</li>
<li>
<p><code>coord_threshold_stream_order</code>: an integer defining the order of stream to aim. 2 or 3 work for most of the cases.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_visualisation">6.4. Visualisation</h3>
<div class="paragraph">
<p><code>lsdtopytools</code> contains some quick routines to visualise data. They are less developed than <code>LSDMappingTools</code> but are directly integrated to <code>lsdtopytools</code>. They allow you to plot the results of the <code>python</code> analysis or to preplot base maps and customise it with <code>matplotlib</code> or to quickly visualise the outputs.</p>
</div>
<div class="sect3">
<h4 id="_base_map_plotting">6.4.1. Base map plotting:</h4>
<div class="paragraph">
<p>The first figure and probably the base of many other is to plot a base map, or simply a topographic map. this can be done with the following function contained into <code>quickplot</code> module. The full function and its use is described as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def plot_nice_topography(mydem ,figure_width = 4, figure_width_units = "inches", cmap = "gist_earth", hillshade = True,
	alpha_hillshade = 0.45, color_min = None, color_max = None, dpi = 300, output = "save", format_figure = "png", fontsize_ticks =6, fontsize_label = 8,
	hillshade_cmin = 0, hillshade_cmax = 250,colorbar = False,
	fig = None, ax = None, colorbar_label = None, colorbar_ax = None):
	"""
		Plot a nice topographic map. You can adjust the following set of parameters to customise it:
		Arguments:
			mydem: the LSDDEM object. Required.
			figure_width (float): figure width in inches (Default value because of matplotlib...) or centimeters.
			figure_width_units (str): "inches" (Default) or "centimetres"
			cmap (str): the name of the colormap to use, see https://matplotlib.org/examples/color/colormaps_reference.html for list.
			hillshade (bool): Drape an hillshade on the top of the figure
			alpha_hillshade (float): regulate the transparency of the hillshade. Between 0 (transparent) and 1 (opaque).
			color_min (float): min elevation corresponding to the min color on the colormap. None = auto.
			color_max (float): see color_min and replace min by max.
			dpi (int): Figure quality, increase will increase the figure quality and its size ofc.
			output (str): "save" to save figure, "return" to return fig/axis, "show" to show.
			format_figure (str): the extension of the saved bitmap: "png", "jpg", "svg" reccomended. For the rest see: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.savefig.html
			fontsize_ticks (float): the fontsize of the ticks
			fontsize_label (float): font size of the labels
			fig (matplotlib figure): Default None, in certain cases you may want to add teh basemap plot on the top of an existing.
			ax (Matplotlib axis): Default None. if custom Figure passed as argument, you also need to pass an axis
			colorbar_label (str): label of the colorbar if activated.
			colorbar_ax (mpl axis): the axis where to place the colorbar (Default will be auto no worries)
		Returns:
			Depends on parameters
		Authors:
			Boris Gailleton
		Date:
			19/12/2018 - last update 09/03/2019
	"""</code></pre>
</div>
</div>
<div class="paragraph">
<p>It allows the user a certain amount of customisations. Note that just using <code>quickplot.plot_nice_topography(mydem)</code> where <code>mydem</code> is a <code>LSDDEM</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_getting_and_saving_data">6.4.2. Getting and Saving Data</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Data will be very soon accessible via <code>pandas</code> dataframes within <code>python</code> (therefore directly savable into <code>csv</code> files). I/O operations for saving processing time will be done via <code>h5py</code>, a htf5 <code>python</code> interface. (htf5 is a very efficient file format for complex storing).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-01-12 09:31:08 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>